import{d as _,g as y,p as C,N as A,c as U,w as h,b as l,a as t,i,q as B,t as o,e as b,x as H,s as w,f as r,h as v,o as a,j as k,F as S,k as P,y as L,z as D}from"./app-RWparKzM.js";import{A as E}from"./AdminLayout--edVSMXj.js";import{_ as M}from"./Pagination-DkGmimez.js";import{_ as T}from"./PaymentStatusBadge-DteZM8cm.js";import{r as j}from"./CreditCardIcon-BhX1AOX7.js";import{r as R}from"./CheckCircleIcon-CCNNkvGD.js";import{r as z}from"./XCircleIcon-BTEXcULU.js";import{r as I}from"./CurrencyDollarIcon-M8nWOnAT.js";import{r as Y}from"./MagnifyingGlassIcon-D0clXtlX.js";import{r as q}from"./ExclamationTriangleIcon-CrF7EtGW.js";import{r as G}from"./ArrowPathIcon-CVpCXSt-.js";import{r as J}from"./PlusIcon-DwarIid2.js";import"./XMarkIcon-Bxj87fHb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserIcon-CDktt_x5.js";import"./UsersIcon-BuHtuOpY.js";import"./ChatBubbleLeftRightIcon-BHCYXGLN.js";import"./ChartBarIcon-DO2uM4cm.js";import"./EyeIcon-C6EZTv3J.js";const K={class:"min-h-screen bg-gradient-to-br from-slate-50 to-white py-8"},Q={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},W={class:"mb-8"},X={class:"flex items-center justify-between"},Z={class:"text-3xl font-bold text-gray-900"},tt={class:"mt-2 text-gray-600"},et={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},st={class:"bg-white rounded-xl shadow-sm p-6 border border-gray-100"},ot={class:"flex items-center"},at={class:"p-3 bg-blue-100 rounded-xl"},lt={class:"ml-4"},rt={class:"text-2xl font-bold text-gray-900"},nt={class:"bg-white rounded-xl shadow-sm p-6 border border-gray-100"},it={class:"flex items-center"},dt={class:"p-3 bg-green-100 rounded-xl"},ct={class:"ml-4"},ut={class:"text-2xl font-bold text-gray-900"},pt={class:"bg-white rounded-xl shadow-sm p-6 border border-gray-100"},mt={class:"flex items-center"},xt={class:"p-3 bg-red-100 rounded-xl"},yt={class:"ml-4"},ft={class:"text-2xl font-bold text-gray-900"},gt={class:"bg-white rounded-xl shadow-sm p-6 border border-gray-100"},_t={class:"flex items-center"},bt={class:"p-3 bg-purple-100 rounded-xl"},vt={class:"ml-4"},ht={class:"text-2xl font-bold text-gray-900"},wt={class:"bg-white rounded-xl shadow-sm border border-gray-100 mb-8"},kt={class:"p-6"},St={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Pt={class:"relative"},Tt={class:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden"},jt={key:0,class:"text-center py-12"},Ft={key:1,class:"text-center py-12"},$t={class:"mt-6"},Nt={key:2},Ot={class:"block md:hidden divide-y divide-gray-100"},Vt={class:"flex justify-between items-start mb-2"},Ct={class:"font-semibold text-gray-900"},At={class:"text-sm text-gray-500"},Ut={class:"text-right"},Bt={class:"font-bold text-gray-900"},Ht={class:"flex justify-between items-center text-sm text-gray-500"},Lt={class:"capitalize"},Dt={key:0},Et={key:0,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},Mt={key:1,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},Rt={class:"hidden md:block overflow-x-auto"},zt={class:"w-full min-w-full divide-y divide-gray-200"},It={class:"bg-white divide-y divide-gray-200"},Yt={class:"px-6 py-4 whitespace-nowrap"},qt={class:"text-sm font-semibold text-gray-900"},Gt={class:"text-sm text-gray-500"},Jt={class:"px-6 py-4 whitespace-nowrap"},Kt={class:"text-sm font-bold text-gray-900"},Qt={class:"px-6 py-4 whitespace-nowrap"},Wt={class:"px-6 py-4 whitespace-nowrap"},Xt={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},Zt={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},te={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ee={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-mono"},se={key:3,class:"text-center py-12"},oe={class:"mt-2 text-gray-500 max-w-md mx-auto"},ae={class:"mt-6"},le={key:4,class:"px-6 py-4 border-t border-gray-200"},Pe={__name:"PaymentHistory",props:{payments:{type:Object,default:()=>({data:[],links:[]})},stats:{type:Object,default:()=>({total_payments:0,successful_payments:0,failed_payments:0,pending_payments:0,total_spent:0})},filters:{type:Object,default:()=>({})},user_role:{type:String,default:"student"},user:{type:Object,default:()=>({})}},setup(f){const d=f,u=_(()=>(console.log("Payments prop:",d.payments),d.payments||{data:[],links:[]})),x=_(()=>(console.log("Stats prop:",d.stats),d.stats||{total_payments:0,successful_payments:0,failed_payments:0,pending_payments:0,total_spent:0})),n=y({search:d.filters?.search||"",status:d.filters?.status||"all",type:d.filters?.type||"all"}),p=y(null),c=y(!1),g=y(!1),F=_(()=>n.value.search!==""||n.value.status!=="all"||n.value.type!=="all"),m=()=>{c.value=!0,g.value=!1,D.get(route("payment.history"),n.value,{preserveState:!0,replace:!0,onFinish:()=>{c.value=!1},onError:()=>{c.value=!1,g.value=!0}})},$=()=>{p.value&&clearTimeout(p.value),p.value=setTimeout(()=>{m()},500)},N=()=>{n.value={search:"",status:"all",type:"all"},m()},O=()=>{window.location.reload()};return C(()=>[n.value.status,n.value.type],()=>{m()}),A(()=>{p.value&&clearTimeout(p.value)}),(V,e)=>(a(),U(E,null,{default:h(()=>[l(i(B),{title:"Payment History"}),t("div",K,[t("div",Q,[t("div",W,[t("div",X,[t("div",null,[t("h1",Z," Payment History for "+o(f.user.name),1),t("p",tt," View "+o(f.user.name)+" payment transactions and billing history ",1)])])]),t("div",et,[t("div",st,[t("div",ot,[t("div",at,[l(i(j),{class:"h-6 w-6 text-blue-600"})]),t("div",lt,[e[3]||(e[3]=t("p",{class:"text-sm font-medium text-gray-600"},"Total Payments",-1)),t("p",rt,o(x.value.total_payments),1)])])]),t("div",nt,[t("div",it,[t("div",dt,[l(i(R),{class:"h-6 w-6 text-green-600"})]),t("div",ct,[e[4]||(e[4]=t("p",{class:"text-sm font-medium text-gray-600"},"Successful",-1)),t("p",ut,o(x.value.successful_payments),1)])])]),t("div",pt,[t("div",mt,[t("div",xt,[l(i(z),{class:"h-6 w-6 text-red-600"})]),t("div",yt,[e[5]||(e[5]=t("p",{class:"text-sm font-medium text-gray-600"},"Failed",-1)),t("p",ft,o(x.value.failed_payments),1)])])]),t("div",gt,[t("div",_t,[t("div",bt,[l(i(I),{class:"h-6 w-6 text-purple-600"})]),t("div",vt,[e[6]||(e[6]=t("p",{class:"text-sm font-medium text-gray-600"},"Total Spent",-1)),t("p",ht," NGN "+o(x.value.total_spent.toLocaleString()),1)])])])]),t("div",wt,[t("div",kt,[t("div",St,[t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Search ",-1)),t("div",Pt,[b(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>n.value.search=s),placeholder:"Search by reference or description...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors",onInput:$},null,544),[[H,n.value.search]]),l(i(Y),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"})])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Status ",-1)),b(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>n.value.status=s),onChange:m,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors"},[...e[8]||(e[8]=[t("option",{value:"all"},"All Status",-1),t("option",{value:"success"},"Successful",-1),t("option",{value:"failed"},"Failed",-1),t("option",{value:"pending"},"Pending",-1)])],544),[[w,n.value.status]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Type ",-1)),b(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>n.value.type=s),onChange:m,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors"},[...e[10]||(e[10]=[t("option",{value:"all"},"All Types",-1),t("option",{value:"subscription"},"Subscriptions",-1),t("option",{value:"one_time"},"One-time Payments",-1)])],544),[[w,n.value.type]])]),t("div",{class:"flex items-end"},[t("button",{onClick:N,class:"w-full px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium"}," Reset Filters ")])])])]),t("div",Tt,[e[19]||(e[19]=t("div",{class:"px-6 py-4 border-b border-gray-200/70"},[t("h2",{class:"text-lg font-bold text-gray-900"}," Transaction History ")],-1)),c.value?(a(),r("div",jt,[...e[12]||(e[12]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600 mx-auto"},null,-1),t("p",{class:"mt-4 text-gray-600"},"Loading payments...",-1)])])):g.value?(a(),r("div",Ft,[l(i(q),{class:"mx-auto h-12 w-12 text-red-500"}),e[14]||(e[14]=t("h3",{class:"mt-4 text-lg font-semibold text-gray-900"}," Unable to load payments ",-1)),e[15]||(e[15]=t("p",{class:"mt-2 text-gray-500 max-w-md mx-auto"}," There was an error loading your payment history. Please try again. ",-1)),t("div",$t,[t("button",{onClick:O,class:"inline-flex items-center px-4 py-2 bg-emerald-600 border border-transparent rounded-lg font-semibold text-white hover:bg-emerald-700 transition-colors"},[l(i(G),{class:"h-5 w-5 mr-2"}),e[13]||(e[13]=k(" Reload Page ",-1))])])])):!c.value&&u.value.data.length>0?(a(),r("div",Nt,[t("div",Ot,[(a(!0),r(S,null,P(u.value.data,s=>(a(),r("div",{key:s.id,class:"p-4 hover:bg-gray-50 transition-colors"},[t("div",Vt,[t("div",null,[t("p",Ct,o(s.description||s.plan_name||"Payment"),1),t("p",At,o(s.reference),1)]),t("div",Ut,[t("p",Bt,o(s.formatted_amount),1),l(T,{status:s.status},null,8,["status"])])]),t("div",Ht,[t("div",null,[t("span",Lt,o(s.status),1),s.paid_at?(a(),r("span",Dt," â€¢ "+o(s.paid_at),1)):v("",!0)]),t("div",null,[s.is_subscription?(a(),r("span",Et," Subscription ")):(a(),r("span",Mt," One-time "))])])]))),128))]),t("div",Rt,[t("table",zt,[e[16]||(e[16]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"}," Transaction "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"}," Amount "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"}," Status "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"}," Type "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"}," Date "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"}," Reference ")])],-1)),t("tbody",It,[(a(!0),r(S,null,P(u.value.data,s=>(a(),r("tr",{key:s.id,class:"hover:bg-gray-50 transition-colors"},[t("td",Yt,[t("div",null,[t("p",qt,o(s.description||s.plan_name||"Payment"),1),t("p",Gt,o(s.is_subscription?"Subscription Plan":"One-time Payment"),1)])]),t("td",Jt,[t("p",Kt,o(s.formatted_amount),1)]),t("td",Qt,[l(T,{status:s.status},null,8,["status"])]),t("td",Wt,[s.is_subscription?(a(),r("span",Xt," Subscription ")):(a(),r("span",Zt," One-time "))]),t("td",te,o(s.paid_at||s.created_at),1),t("td",ee,o(s.reference),1)]))),128))])])])])):!c.value&&u.value.data.length===0?(a(),r("div",se,[l(i(j),{class:"mx-auto h-12 w-12 text-gray-400"}),e[18]||(e[18]=t("h3",{class:"mt-4 text-lg font-semibold text-gray-900"}," No payments found ",-1)),t("p",oe,o(F.value?"Try adjusting your filters to see more results.":"You haven't made any payments yet."),1),t("div",ae,[l(i(L),{href:V.route("payment.pricing"),class:"inline-flex items-center px-4 py-2 bg-emerald-600 border border-transparent rounded-lg font-semibold text-white hover:bg-emerald-700 transition-colors"},{default:h(()=>[l(i(J),{class:"h-5 w-5 mr-2"}),e[17]||(e[17]=k(" Make Your First Payment ",-1))]),_:1},8,["href"])])])):v("",!0),!c.value&&u.value.data.length>0?(a(),r("div",le,[l(M,{links:u.value.links||[]},null,8,["links"])])):v("",!0)])])])]),_:1}))}};export{Pe as default};
