import{f as a,a as e,o,d as T,g as m,b as c,h as d,t as l,i as x,n as f,A as J,F as z,j as S,c as D,r as b,l as re,M as qe,e as ze,q as Pt,U as Ft,z as Ye,s as st,B as Ot,K as We,N as Et,m as Ze,w as Ce,p as Rt,x as Xe,k as It,y as L}from"./app-bHyfwQwP.js";import{r as ie,S as Lt}from"./StudentLayout-it0hCN4Y.js";import{k as Je}from"./marked.esm-B5D8JARp.js";import{p as Nt}from"./purify.es-HRjpPm7y.js";import{_ as rt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as ot,c as Qt}from"./XMarkIcon-DbIGV9st.js";import{r as be}from"./AcademicCapIcon-CNdIHbMp.js";import{r as Ae}from"./ChevronDownIcon-C8d5Equr.js";import{r as X}from"./CheckCircleIcon-DHn9ul95.js";import{r as Se}from"./ClockIcon-CAvzOg5w.js";import{r as de}from"./QuestionMarkCircleIcon-BlXACcZB.js";import{r as Te}from"./ChatBubbleLeftRightIcon-f6JJZ7a_.js";import{r as Dt}from"./ExclamationTriangleIcon-De6pIeHY.js";import{r as Vt}from"./PaperAirplaneIcon-eF00WjtG.js";import{a as Bt,c as ne}from"./UserIcon-_y9HoBzG.js";import{r as et}from"./ListBulletIcon-BgaOzvcN.js";import{r as Ut}from"./TagIcon-lpDfV72x.js";import{r as Gt}from"./LinkIcon-CORQdu8r.js";import{r as tt}from"./CheckIcon-t5u_DmMt.js";import{r as Kt}from"./ArrowDownTrayIcon-DSz0uAUW.js";import"./SparklesIcon-CSO7NOZz.js";import"./PlusIcon-CACRYMFk.js";import"./BellIcon-Byxl_w52.js";import"./CreditCardIcon-11OZiRf4.js";function ge(n,i){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 0 0 .75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 0 0-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0 1 12 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 0 1-.673-.38m0 0A2.18 2.18 0 0 1 3 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 0 1 3.413-.387m7.5 0V5.25A2.25 2.25 0 0 0 13.5 3h-3a2.25 2.25 0 0 0-2.25 2.25v.894m7.5 0a48.667 48.667 0 0 0-7.5 0M12 12.75h.008v.008H12v-.008Z"})])}function ce(n,i){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})])}function Ht(n,i){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.25 9v6m-4.5 0V9M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function oe(n,i){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"})])}function Yt(n,i){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 9.563C9 9.252 9.252 9 9.563 9h4.874c.311 0 .563.252.563.563v4.874c0 .311-.252.563-.563.563H9.564A.562.562 0 0 1 9 14.437V9.564Z"})])}const Wt={key:0,class:"lg:hidden fixed inset-0 flex z-50"},Zt={class:"relative flex-1 flex flex-col max-w-xs w-full bg-white shadow-xl"},Xt={class:"absolute top-0 right-0 -mr-12 pt-4"},Jt={class:"flex flex-col h-full"},es={class:"p-6 bg-gradient-to-r from-emerald-600 to-teal-600 text-white"},ts={class:"flex items-center justify-between mb-3"},ss={class:"text-lg font-bold truncate"},rs={class:"flex items-center justify-between text-sm text-emerald-100"},os={class:"flex items-center"},as={class:"p-4 border-b border-gray-200 bg-white"},ls={class:"space-y-3"},ns={class:"flex justify-between text-sm text-gray-600 mb-1"},is={class:"font-semibold"},ds={class:"w-full bg-gray-200 rounded-full h-2.5"},cs={class:"grid grid-cols-2 gap-3 text-xs"},us={class:"text-center p-2 bg-emerald-50 rounded-lg"},ms={class:"font-bold text-emerald-700"},vs={class:"text-center p-2 bg-teal-50 rounded-lg"},ps={class:"font-bold text-teal-700"},gs={class:"flex-1 overflow-y-auto"},bs={class:"p-4 space-y-2"},hs=["onClick"],xs={class:"flex items-center flex-1 min-w-0"},fs={class:"w-8 h-8 rounded-full bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center text-white font-bold text-sm mr-3 flex-shrink-0"},ys={class:"flex-1 min-w-0"},_s={class:"font-bold text-gray-900 truncate text-sm"},ws={class:"text-xs text-gray-500 mt-1"},ks={class:"flex items-center space-x-2 flex-shrink-0"},$s={class:"w-12 bg-gray-200 rounded-full h-1.5"},js={key:0,class:"bg-gray-50 border-t border-gray-100"},Cs=["onClick"],Ts={class:"flex items-center flex-1 min-w-0"},qs={key:1},zs={class:"flex-1 min-w-0"},Ss={class:"text-sm font-medium text-gray-900 truncate"},As={class:"text-xs text-gray-500 mt-0.5 flex items-center"},Ms={key:0,class:"ml-2 inline-flex items-center"},Ps={class:"flex items-center space-x-2 flex-shrink-0 ml-2"},Fs={key:0,class:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"},Os={class:"p-4 border-t border-gray-200 bg-white space-y-3"},Es={class:"grid grid-cols-2 gap-2"},Rs={__name:"LearnMobileSidebar",props:{open:Boolean,course:Object,courseStructure:Array,currentTopic:Object,courseStats:Object,expandedModules:Object},emits:["close","selectTopic","toggleModule"],setup(n,{emit:i}){const N=n,A=i,P=T(()=>N.courseStructure.flatMap($=>$.topics)),q=T(()=>P.value.findIndex($=>$.id===N.currentTopic.id)),E=T(()=>q.value>0),w=T(()=>q.value<P.value.length-1),C=$=>{A("selectTopic",$),A("close")},_=()=>{if(E.value){const $=P.value[q.value-1];C($)}},F=()=>{if(w.value){const $=P.value[q.value+1];C($)}},k=$=>({draft:"bg-gray-100 text-gray-800",active:"bg-emerald-100 text-emerald-800",paused:"bg-amber-100 text-amber-800",completed:"bg-teal-100 text-teal-800"})[$]||"bg-gray-100 text-gray-800";return($,h)=>n.open?(o(),a("div",Wt,[e("div",{class:"fixed inset-0 bg-gray-600 bg-opacity-75 transition-opacity",onClick:h[0]||(h[0]=y=>$.$emit("close"))}),e("div",Zt,[e("div",Xt,[e("button",{onClick:h[1]||(h[1]=y=>$.$emit("close")),class:"ml-1 flex items-center justify-center h-10 w-10 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-colors"},[c(d(ot),{class:"h-6 w-6"})])]),e("div",Jt,[e("div",es,[e("div",ts,[e("h2",ss,l(n.course.title),1)]),e("div",rs,[e("div",os,[c(d(be),{class:"h-4 w-4 mr-1"}),x(" "+l(n.courseStats.completed_modules||0)+"/"+l(n.courseStats.total_modules||0)+" Modules ",1)]),e("span",{class:f(["inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold",k(n.course.status)])},l(n.course.status),3)])]),e("div",as,[e("div",ls,[e("div",null,[e("div",ns,[h[2]||(h[2]=e("span",null,"Overall Progress",-1)),e("span",is,l(n.courseStats.overall_completion_percentage||0)+"%",1)]),e("div",ds,[e("div",{class:"bg-gradient-to-r from-emerald-500 to-teal-500 h-2.5 rounded-full transition-all duration-500",style:J({width:`${n.courseStats.overall_completion_percentage||0}%`})},null,4)])]),e("div",cs,[e("div",us,[e("div",ms,l(n.courseStats.completed_modules||0)+"/"+l(n.courseStats.total_modules||0),1),h[3]||(h[3]=e("div",{class:"text-emerald-600"},"Modules",-1))]),e("div",vs,[e("div",ps,l(n.courseStats.completed_topics||0)+"/"+l(n.courseStats.total_topics||0),1),h[4]||(h[4]=e("div",{class:"text-teal-600"},"Topics",-1))])])])]),e("div",gs,[e("nav",bs,[(o(!0),a(z,null,S(n.courseStructure,y=>(o(),a("div",{key:y.id,class:"border border-gray-200 rounded-xl overflow-hidden"},[e("div",{onClick:j=>$.$emit("toggleModule",y.id),class:f(["flex items-center justify-between p-4 cursor-pointer transition-colors",n.expandedModules[y.id]?"bg-emerald-50 border-b border-emerald-100":"bg-white hover:bg-gray-50"])},[e("div",xs,[e("div",fs,l(y.order),1),e("div",ys,[e("h3",_s,l(y.title),1),e("p",ws,l(y.completed_topics)+"/"+l(y.total_topics)+" topics â€¢ "+l(y.estimated_duration_minutes)+"min ",1)])]),e("div",ks,[e("div",$s,[e("div",{class:"bg-emerald-500 h-1.5 rounded-full transition-all duration-300",style:J({width:`${y.completed_topics/y.total_topics*100}%`})},null,4)]),c(d(Ae),{class:f(["h-4 w-4 text-gray-400 transition-transform duration-200",{"rotate-180":n.expandedModules[y.id]}])},null,8,["class"])])],10,hs),n.expandedModules[y.id]?(o(),a("div",js,[(o(!0),a(z,null,S(y.topics,j=>(o(),a("div",{key:j.id,onClick:V=>C(j),class:f(["group flex items-center px-4 py-3 cursor-pointer transition-all duration-200 border-l-4",n.currentTopic.id===j.id?"bg-white border-emerald-500 shadow-sm":"hover:bg-white hover:border-emerald-200 border-transparent",(j.is_completed,"opacity-100")])},[e("div",Ts,[e("div",{class:f(["w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium mr-3 flex-shrink-0 border-2",n.currentTopic.id===j.id||j.is_completed?"bg-emerald-500 text-white border-emerald-500":"bg-white text-gray-400 border-gray-300"])},[j.is_completed?(o(),D(d(X),{key:0,class:"h-3 w-3"})):(o(),a("span",qs,l(j.order),1))],2),e("div",zs,[e("h4",Ss,l(j.title),1),e("p",As,[c(d(Se),{class:"h-3 w-3 mr-1"}),x(" "+l(j.estimated_duration_minutes)+"min ",1),j.has_quiz?(o(),a("span",Ms,[c(d(de),{class:"h-3 w-3 mr-1"}),h[5]||(h[5]=x(" Quiz ",-1))])):m("",!0)])])]),e("div",Ps,[n.currentTopic.id===j.id?(o(),a("div",Fs)):m("",!0),!j.is_completed&&n.currentTopic.id!==j.id?(o(),D(d(oe),{key:1,class:"h-4 w-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity"})):m("",!0)])],10,Cs))),128))])):m("",!0)]))),128))])]),e("div",Os,[e("div",Es,[E.value?(o(),a("button",{key:0,onClick:_,class:"flex items-center justify-center px-3 py-2.5 border border-emerald-300 text-emerald-700 font-medium rounded-lg hover:bg-emerald-50 transition-colors text-sm"},[c(d(ce),{class:"h-4 w-4 mr-1"}),h[6]||(h[6]=x(" Previous ",-1))])):m("",!0),w.value?(o(),a("button",{key:1,onClick:F,class:"flex items-center justify-center px-3 py-2.5 bg-gradient-to-r from-emerald-600 to-teal-600 text-white font-medium rounded-lg hover:from-emerald-700 hover:to-teal-700 transition-all duration-200 shadow-sm hover:shadow-md text-sm"},[h[7]||(h[7]=x(" Next ",-1)),c(d(ie),{class:"h-4 w-4 ml-1"})])):m("",!0)])])])])])):m("",!0)}},Is=rt(Rs,[["__scopeId","data-v-90d0849c"]]),Ls={key:0,class:"fixed inset-0 z-50 overflow-hidden","aria-labelledby":"chat-modal",role:"dialog","aria-modal":"true"},Ns={class:"fixed inset-y-0 right-0 max-w-full flex"},Qs={class:"h-full flex flex-col bg-white shadow-xl rounded-l-2xl overflow-hidden"},Ds={class:"bg-gradient-to-r from-emerald-600 to-teal-600 px-4 py-6 sm:px-6"},Vs={class:"flex items-center justify-between"},Bs={class:"flex items-center space-x-3"},Us={class:"flex-shrink-0"},Gs={class:"h-10 w-10 bg-white/20 rounded-full flex items-center justify-center"},Ks={class:"mt-1 text-sm text-emerald-100"},Hs={key:0,class:"mt-4"},Ys={class:"relative"},Ws=["disabled"],Zs=["value"],Xs={class:"absolute right-2 top-1/2 transform -translate-y-1/2 pointer-events-none"},Js={key:0,class:"absolute right-8 top-1/2 transform -translate-y-1/2"},er={key:0,class:"text-xs text-emerald-200 mt-1 flex items-center"},tr={key:0,class:"text-center py-8"},sr={class:"mx-auto h-16 w-16 bg-gradient-to-r from-emerald-500 to-teal-500 rounded-full flex items-center justify-center mb-4"},rr={class:"text-sm text-gray-600 max-w-xs mx-auto"},or={class:"text-emerald-600"},ar={key:1,class:"text-center py-8"},lr=["innerHTML"],nr={key:0,class:"ml-2 px-1.5 py-0.5 bg-amber-100 text-amber-700 rounded text-xs"},ir={key:2,class:"flex justify-start"},dr={key:3,class:"flex justify-center"},cr={class:"bg-red-50 border border-red-200 rounded-2xl px-4 py-3 max-w-[85%]"},ur={class:"flex items-center"},mr={class:"text-sm text-red-700"},vr={class:"flex-1 relative"},pr=["onKeydown","disabled"],gr={class:"absolute bottom-2 right-2"},br=["disabled"],hr={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},xr={key:0,class:"text-xs text-red-500 mt-2 text-center"},fr={__name:"CourseChatPopup",props:{course:{type:Object,required:!0},availableTopics:{type:Array,default:()=>[]}},setup(n){const i=n,N=b(!1),A=b(""),P=b(!1),q=b(!1),E=b(!1),w=b(""),C=b([]),_=b(null),F=b(null),k=b(null),$=b(!1),h=T(()=>i.availableTopics||[]),y=b(""),j=()=>{$.value=window.innerWidth<768},V=async()=>{N.value=!0,k.value=null,E.value=!0;try{await B()}catch(g){console.error("Failed to initialize chat:",g),k.value="Failed to load chat. Please try again."}finally{E.value=!1}We(()=>{M()})},O=()=>{N.value=!1,A.value="",k.value=null},B=async()=>{try{const g=await axios.get(route("student.courses.tutor.session",{course:i.course.id}));if(g.data.success)_.value=g.data.session,C.value=g.data.messages||[];else throw new Error(g.data.error||"Failed to load session")}catch(g){throw console.error("Failed to initialize session:",g),g}},G=async()=>{if(!A.value.trim()||P.value||A.value.length>500)return;const g=A.value.trim();A.value="",P.value=!0,q.value=!0,k.value=null;const p={id:Date.now(),sender_type:"user",message:g,created_at:new Date().toISOString(),is_related_to_topic:!0};C.value.push(p),M();try{const v=await axios.post(route("student.courses.tutor.send-message",{course:i.course.id}),{message:g,outline_id:w.value||null});if(v.data.success){const R={id:v.data.message.id||Date.now()+1,sender_type:"ai",message:v.data.message.message,created_at:v.data.message.created_at,is_related_to_topic:v.data.message.is_related_to_topic,metadata:v.data.message.metadata};C.value.push(R),v.data.session_id&&!_.value&&(_.value={id:v.data.session_id})}else throw new Error(v.data.error||"Failed to send message")}catch(v){console.error("Failed to send message:",v);const R={id:Date.now()+1,sender_type:"ai",message:"I'm sorry, I'm having trouble responding right now. Please try again.",created_at:new Date().toISOString(),is_related_to_topic:!0};C.value.push(R),k.value="Failed to send message. Please try again."}finally{P.value=!1,q.value=!1,M()}},U=async()=>{if(!_.value){await K();return}k.value=null,q.value=!0,y.value=_.value.course_outline_id;try{const g=await axios.post(route("student.courses.tutor.update-context",{course:i.course.id}),{outline_id:w.value||null,session_id:_.value.id});if(g.data.success){_.value&&(_.value.course_outline_id=w.value,_.value.topic_context=g.data.new_context);const p=w.value?h.value.find(R=>R.id===w.value)?.title:"General Course Questions",v={id:Date.now(),sender_type:"ai",message:`ðŸ“š <strong>Context Updated:</strong> Now focusing on <em>"${p}"</em>. Ask me anything specific about this topic!`,created_at:new Date().toISOString(),is_related_to_topic:!0,is_system:!0};C.value.push(v),M()}else throw new Error(g.data.error||"Failed to update context")}catch(g){console.error("Context update failed:",g),w.value=y.value,g.response?.data?.error?k.value=g.response.data.error:g.response?.status===404?k.value="The selected topic was not found in this course.":g.response?.status===403?k.value="You do not have permission to modify this chat session.":g.code==="NETWORK_ERROR"?k.value="Network error. Please check your connection and try again.":k.value="Failed to update chat context. Please try again.",setTimeout(()=>{k.value=null},5e3)}finally{q.value=!1}},K=async()=>{k.value=null,q.value=!0;try{const g=w.value?"I'd like to focus on this specific topic.":"I'd like to discuss general course questions.",p=await axios.post(route("student.courses.tutor.send-message",{course:i.course.id}),{message:g,outline_id:w.value||null});if(p.data.success){_.value={id:p.data.session_id};const v={id:p.data.message.id||Date.now()+1,sender_type:"ai",message:p.data.message.message,created_at:p.data.message.created_at,is_related_to_topic:p.data.message.is_related_to_topic,metadata:p.data.message.metadata};C.value.push(v);const R=w.value?h.value.find(ue=>ue.id===w.value)?.title:"General Course Questions",he={id:Date.now()+2,sender_type:"ai",message:`ðŸŽ¯ <strong>Chat Context Set:</strong> I'll focus on <em>"${R}"</em>. What would you like to know about this topic?`,created_at:new Date().toISOString(),is_related_to_topic:!0,is_system:!0};C.value.push(he),M()}else throw new Error(p.data.error||"Failed to create session")}catch(g){console.error("Failed to create session with context:",g),k.value="Failed to start chat with selected context. Please try again.",w.value=""}finally{q.value=!1}},ee=g=>g?g.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`(.*?)`/g,'<code class="bg-gray-100 px-1 rounded text-xs">$1</code>').replace(/\n/g,"<br>"):"",H=g=>g?new Date(g).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",M=()=>{We(()=>{F.value&&(F.value.scrollTop=F.value.scrollHeight)})},Y=g=>{g.key==="Escape"&&N.value&&O()},W=()=>{j()};return re(()=>{document.addEventListener("keydown",Y),window.addEventListener("resize",W),j()}),qe(()=>{document.removeEventListener("keydown",Y),window.removeEventListener("resize",W)}),(g,p)=>(o(),a("div",null,[e("button",{onClick:V,class:f(["fixed z-40 flex items-center gap-2 px-4 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 group",["right-4 md:right-6",$.value?"bottom-20":"bottom-6"]]),title:"Ask AI Tutor"},[c(d(Te),{class:"h-5 w-5 group-hover:scale-110 transition-transform"}),p[2]||(p[2]=e("span",{class:"text-sm font-semibold whitespace-nowrap"},"Ask the Tutor",-1))],2),N.value?(o(),a("div",Ls,[e("div",{class:"absolute inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:O}),e("div",Ns,[e("div",{class:f(["w-screen max-w-md h-full transform transition-transform duration-300 ease-in-out",N.value?"translate-x-0":"translate-x-full"])},[e("div",Qs,[e("div",Ds,[e("div",Vs,[e("div",Bs,[e("div",Us,[e("div",Gs,[c(d(Te),{class:"h-6 w-6 text-white"})])]),e("div",null,[p[3]||(p[3]=e("h2",{class:"text-lg font-bold text-white",id:"chat-modal"}," Oli Ai Tutor ",-1)),e("p",Ks,l(n.course.title),1)])]),e("button",{onClick:O,class:"rounded-md p-2 text-emerald-200 hover:text-white hover:bg-white/10 transition-colors focus:outline-none focus:ring-2 focus:ring-white"},[p[4]||(p[4]=e("span",{class:"sr-only"},"Close panel",-1)),c(d(ot),{class:"h-5 w-5"})])]),h.value.length>0?(o(),a("div",Hs,[p[8]||(p[8]=e("label",{class:"block text-xs font-medium text-emerald-100 mb-2"}," Focus on specific topic: ",-1)),e("div",Ys,[ze(e("select",{"onUpdate:modelValue":p[0]||(p[0]=v=>w.value=v),onChange:U,class:"w-full px-3 py-2 text-sm border border-emerald-300 rounded-lg focus:ring-2 focus:ring-white focus:border-white bg-emerald-500 text-white placeholder-emerald-200 appearance-none pr-8 transition-colors",disabled:q.value},[p[5]||(p[5]=e("option",{value:""},"General Course Questions",-1)),(o(!0),a(z,null,S(h.value,v=>(o(),a("option",{key:v.id,value:v.id},l(v.full_title||v.title),9,Zs))),128))],40,Ws),[[Pt,w.value]]),e("div",Xs,[c(d(Ae),{class:"h-4 w-4 text-emerald-200"})]),q.value?(o(),a("div",Js,[...p[6]||(p[6]=[e("div",{class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},null,-1)])])):m("",!0)]),q.value?(o(),a("p",er,[...p[7]||(p[7]=[e("div",{class:"animate-spin rounded-full h-3 w-3 border-b-2 border-emerald-200 mr-1"},null,-1),x(" Updating context... ",-1)])])):m("",!0)])):m("",!0)]),e("div",{ref_key:"messagesContainer",ref:F,class:f(["flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50/50",$.value?"pb-20":""])},[C.value.length===0&&!E.value?(o(),a("div",tr,[e("div",sr,[c(d(Te),{class:"h-8 w-8 text-white"})]),p[11]||(p[11]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-2"}," Welcome to AI Tutor! ",-1)),e("p",rr,[p[9]||(p[9]=x(" Ask me anything about ",-1)),e("strong",or,l(n.course.title),1),p[10]||(p[10]=x(". I'm here to help you learn! ",-1))])])):m("",!0),E.value&&C.value.length===0?(o(),a("div",ar,[...p[12]||(p[12]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600 mx-auto mb-4"},null,-1),e("p",{class:"text-sm text-gray-500"},"Loading chat...",-1)])])):m("",!0),(o(!0),a(z,null,S(C.value,(v,R)=>(o(),a("div",{key:v.id||R,class:f(["flex",{"justify-end":v.sender_type==="user","justify-start":v.sender_type==="ai"}])},[e("div",{class:f(["max-w-[85%] rounded-2xl px-4 py-3 shadow-sm transition-all duration-200",{"bg-gradient-to-r from-emerald-600 to-teal-600 text-white":v.sender_type==="user","bg-white border border-gray-200 shadow-sm":v.sender_type==="ai","border-l-4 border-l-emerald-500":v.sender_type==="ai"&&v.is_system}])},[e("div",{class:"text-sm leading-relaxed",innerHTML:ee(v.message)},null,8,lr),e("p",{class:f(["text-xs mt-2 flex items-center",{"text-emerald-200":v.sender_type==="user","text-gray-500":v.sender_type==="ai"}])},[x(l(H(v.created_at))+" ",1),v.sender_type==="ai"&&!v.is_related_to_topic?(o(),a("span",nr," May be off-topic ")):m("",!0)],2)],2)],2))),128)),q.value?(o(),a("div",ir,[...p[13]||(p[13]=[Ft('<div class="bg-white border border-gray-200 rounded-2xl px-4 py-3 shadow-sm"><div class="flex items-center space-x-2"><div class="flex space-x-1"><div class="w-2 h-2 bg-emerald-400 rounded-full animate-bounce" style="animation-delay:0.1s;"></div><div class="w-2 h-2 bg-emerald-400 rounded-full animate-bounce" style="animation-delay:0.2s;"></div><div class="w-2 h-2 bg-emerald-400 rounded-full animate-bounce" style="animation-delay:0.3s;"></div></div><span class="text-xs text-gray-500">AI Tutor is typing...</span></div></div>',1)])])):m("",!0),k.value?(o(),a("div",dr,[e("div",cr,[e("div",ur,[c(d(Dt),{class:"h-4 w-4 text-red-500 mr-2"}),e("p",mr,l(k.value),1)])])])):m("",!0)],2),e("div",{class:f(["border-t border-gray-200 p-4 bg-white",$.value?"pb-6":""])},[e("form",{onSubmit:Ye(G,["prevent"]),class:"flex space-x-3"},[e("div",vr,[ze(e("textarea",{"onUpdate:modelValue":p[1]||(p[1]=v=>A.value=v),onKeydown:Ot(Ye(G,["exact","prevent"]),["enter"]),rows:"2",placeholder:"Ask a question about this course...",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 resize-none text-sm shadow-sm transition-colors",disabled:P.value||E.value},null,40,pr),[[st,A.value]]),e("div",gr,[e("span",{class:f(["text-xs text-gray-400",{"text-emerald-600":A.value.length>0}])},l(A.value.length)+"/500 ",3)])]),e("button",{type:"submit",disabled:!A.value.trim()||P.value||E.value||A.value.length>500,class:f(["self-end px-4 py-3 bg-gradient-to-r from-emerald-600 to-teal-600 text-white rounded-xl hover:from-emerald-700 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-sm flex items-center justify-center min-w-[44px]",{"hover:scale-105":!P.value&&A.value.trim(),"transform scale-95":P.value}])},[P.value?(o(),a("div",hr)):(o(),D(d(Vt),{key:0,class:"h-4 w-4"}))],10,br)],32),A.value.length>500?(o(),a("p",xr," Message too long. Please keep under 500 characters. ")):m("",!0)],2)])],2)])])):m("",!0)]))}},yr={class:"h-screen flex overflow-hidden bg-gradient-to-br from-slate-50 to-emerald-50"},_r={class:"hidden lg:flex lg:flex-shrink-0 lg:w-80 xl:w-96"},wr={class:"flex flex-col w-full border-r border-gray-200 bg-white shadow-sm"},kr={class:"p-6 bg-gradient-to-r from-emerald-600 to-teal-600 text-white"},$r={class:"text-xl font-bold leading-tight line-clamp-2 mb-2"},jr={class:"flex items-center justify-between"},Cr={class:"flex items-center space-x-2"},Tr={class:"flex items-center text-emerald-100 text-sm"},qr={class:"p-4 border-b border-gray-200 bg-white"},zr={class:"space-y-4"},Sr={class:"flex justify-between text-sm text-gray-600 mb-2"},Ar={class:"font-semibold"},Mr={class:"w-full bg-gray-200 rounded-full h-3"},Pr={class:"flex-1 overflow-y-auto"},Fr={class:"p-4 space-y-2"},Or=["onClick"],Er={class:"flex items-center flex-1 min-w-0"},Rr={class:"w-8 h-8 rounded-full bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center text-white font-bold text-sm mr-3 flex-shrink-0"},Ir={class:"flex-1 min-w-0"},Lr={class:"font-semibold text-gray-900 truncate"},Nr={class:"text-xs text-gray-500 mt-1"},Qr={class:"flex items-center space-x-2 flex-shrink-0"},Dr={class:"w-20 bg-gray-200 rounded-full h-2"},Vr={class:"text-xs text-gray-500 font-medium"},Br={key:0,class:"bg-gray-50 border-t border-gray-100"},Ur=["onClick"],Gr={class:"flex items-center flex-1 min-w-0"},Kr={key:1},Hr={class:"flex-1 min-w-0"},Yr={class:"text-sm font-medium text-gray-900 truncate"},Wr={class:"text-xs text-gray-500 mt-0.5 flex items-center"},Zr={key:0,class:"ml-2 inline-flex items-center"},Xr={key:1,class:"ml-2 inline-flex items-center"},Jr={class:"flex items-center space-x-2 flex-shrink-0 ml-2"},eo={key:0,class:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"},to={class:"p-4 border-t border-gray-200 bg-white space-y-3"},so={class:"grid grid-cols-2 gap-2"},ro={class:"flex flex-col w-0 flex-1 overflow-hidden"},oo={class:"lg:hidden bg-white border-b border-gray-200 shadow-sm"},ao={class:"flex items-center justify-between px-4 py-3"},lo={class:"flex items-center space-x-3"},no={class:"flex-1 min-w-0"},io={class:"text-sm font-semibold text-gray-900 truncate"},co={class:"text-xs text-gray-500 truncate"},uo={class:"flex items-center space-x-2"},mo={class:"text-right"},vo={class:"text-sm font-medium text-gray-900"},po={class:"flex-1 relative overflow-y-auto focus:outline-none bg-transparent"},go={class:"py-6 px-4 sm:px-6 lg:px-8 max-w-6xl mx-auto"},bo={class:"mb-6"},ho={class:"flex items-start justify-between mb-4"},xo={class:"flex-1"},fo={class:"flex items-center space-x-2 text-sm text-gray-500 mb-3"},yo={class:"text-gray-900 font-medium"},_o={class:"flex items-start justify-between"},wo={class:"flex-1"},ko={class:"flex items-center space-x-3 mb-2"},$o={class:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-emerald-100 text-emerald-800"},jo={class:"text-sm text-gray-500 flex items-center"},Co={class:"text-2xl lg:text-3xl font-bold text-gray-900 leading-tight"},To={key:0,class:"mt-2 text-lg text-gray-600 leading-relaxed"},qo={key:0,class:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm"},zo={class:"flex items-center justify-between mb-2"},So={class:"text-sm text-gray-500"},Ao={class:"w-full bg-gray-200 rounded-full h-2.5"},Mo={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},Po={class:"border-b border-gray-200"},Fo={class:"flex space-x-8 px-6","aria-label":"Tabs"},Oo=["onClick"],Eo={class:"flex items-center"},Ro={class:"p-6"},Io={key:0,class:"prose prose-lg max-w-none"},Lo={key:0,class:"mb-6"},No={class:"flex items-center justify-between p-4 bg-emerald-50 rounded-lg border border-emerald-200"},Qo={class:"flex items-center space-x-4"},Do=["disabled"],Vo={class:"flex items-center space-x-4"},Bo={class:"text-sm text-gray-500"},Uo=["disabled"],Go={key:0,class:"w-full bg-gray-200 rounded-full h-2 mt-2"},Ko={key:1,class:"space-y-6"},Ho=["innerHTML"],Yo={class:"mt-4 flex items-center justify-between p-3 bg-gray-50 rounded-lg"},Wo=["onClick"],Zo={class:"text-sm text-gray-500"},Xo={key:2,class:"text-center py-12"},Jo=["disabled"],ea={key:1,class:"space-y-6"},ta={key:0},sa={class:"grid gap-3"},ra={class:"text-emerald-800"},oa={key:1},aa={class:"flex flex-wrap gap-2"},la={key:2},na={class:"space-y-2"},ia={class:"text-gray-700"},da={key:2,class:"space-y-6"},ca={key:0,class:"space-y-6"},ua={class:"bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-xl p-6"},ma={class:"flex items-start justify-between mb-4"},va={class:"flex-1"},pa={class:"text-xl font-semibold text-gray-900 mb-2"},ga={class:"text-gray-600 mb-4"},ba={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},ha={class:"text-center p-3 bg-white rounded-lg border border-amber-100"},xa={class:"font-bold text-amber-700"},fa={class:"text-center p-3 bg-white rounded-lg border border-amber-100"},ya={class:"font-bold text-amber-700"},_a={class:"text-center p-3 bg-white rounded-lg border border-amber-100"},wa={class:"font-bold text-amber-700"},ka={class:"text-center p-3 bg-white rounded-lg border border-amber-100"},$a={class:"font-bold text-amber-700"},ja=["disabled"],Ca={key:0,class:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm"},Ta={class:"space-y-3"},qa={class:"flex items-center space-x-4"},za={class:"font-medium text-gray-900"},Sa={class:"text-sm text-gray-500"},Aa={class:"flex items-center space-x-2"},Ma=["onClick"],Pa={key:1,class:"space-y-6"},Fa={class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},Oa={class:"flex items-center justify-between mb-4"},Ea={class:"text-xl font-semibold text-gray-900"},Ra={class:"text-gray-600"},Ia={class:"text-right"},La={class:"w-full bg-gray-200 rounded-full h-2.5 mb-4"},Na={class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},Qa={class:"text-lg font-semibold text-gray-900 mb-4"},Da={key:0,class:"space-y-3"},Va=["onClick"],Ba={class:"flex items-center"},Ua={class:"text-gray-700"},Ga={key:1,class:"grid grid-cols-2 gap-4"},Ka=["onClick"],Ha={class:"font-medium text-gray-700"},Ya={class:"flex justify-between items-center mt-6 pt-6 border-t border-gray-200"},Wa=["disabled"],Za={class:"flex items-center space-x-3"},Xa=["disabled"],Ja=["disabled"],el={key:2,class:"space-y-6"},tl={class:"bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-xl p-6"},sl={class:"text-center"},rl={class:"text-2xl font-bold text-gray-900 mb-2"},ol={class:"text-gray-600 mb-4"},al={class:"flex justify-center space-x-4"},ll={class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},nl={class:"space-y-4"},il={class:"flex items-start justify-between mb-2"},dl={class:"font-medium text-gray-900"},cl={class:"text-gray-700 mb-3"},ul={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},ml={key:0},vl={class:"mt-1 text-emerald-700"},pl={key:0,class:"mt-3 p-3 bg-blue-50 rounded-lg"},gl={class:"mt-1 text-blue-600"},bl={key:3,class:"text-center py-12"},hl=["disabled"],xl={key:3,class:"space-y-6"},fl={class:"bg-gradient-to-r from-purple-50 to-indigo-50 border border-purple-200 rounded-xl p-6"},yl={class:"flex items-start justify-between mb-4"},_l={class:"flex-1"},wl={class:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm"},kl={class:"text-center p-3 bg-white rounded-lg border border-purple-100"},$l={class:"font-bold text-purple-700"},jl={key:0,class:"bg-white rounded-xl border border-purple-100 p-4 mb-4 shadow-sm"},Cl={class:"space-y-2"},Tl={class:"text-gray-700"},ql={class:"flex space-x-4"},zl={key:0,class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},Sl={class:"space-y-4"},Al={class:"flex justify-end space-x-3"},Ml=["disabled"],Pl={key:1,class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},Fl={class:"space-y-3"},Ol={class:"flex items-center justify-between mb-2"},El={class:"font-medium text-gray-900"},Rl={class:"text-gray-600 text-sm mb-3"},Il={key:0,class:"p-3 bg-blue-50 rounded-lg"},Ll={class:"mt-1 text-blue-600"},Nl={key:4,class:"space-y-6"},Ql={class:"bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-xl p-6"},Dl={class:"flex items-start justify-between mb-4"},Vl={class:"flex-1"},Bl={class:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm"},Ul={class:"text-center p-3 bg-white rounded-lg border border-blue-100"},Gl={class:"font-bold text-blue-700"},Kl={key:0,class:"bg-white rounded-xl border border-blue-100 p-4 mb-4 shadow-sm"},Hl={class:"space-y-3"},Yl={class:"font-medium text-gray-900"},Wl={key:1,class:"text-center py-8"},Zl=["disabled"],Xl={class:"mt-8 flex justify-between items-center"},Jl={key:1},en={class:"flex items-center space-x-4"},tn=["disabled","title"],sn={key:1,disabled:"",class:"inline-flex items-center px-6 py-3 bg-gray-400 text-white font-medium rounded-lg cursor-not-allowed"},rn={__name:"Learn",props:{course:Object,course_structure:Array,current_topic:Object,course_stats:Object,active_tab:String,show_quiz_tab:Boolean},setup(n){const i=n,N=b(null),P=Et().props.active_tab,q=b(!1),E=b(!1),w=b(!1),C=b(!1),_=b(P||urlTabParam||"content"),F=b({}),k=b("overview"),$=b(null),h=b(0),y=b(null),j=b([]),V=b(0),O=b(null),B=b(null),G=b("overview"),U=b(""),K=b(null),ee=b(null),H=b(0),M=b(!1),Y=b("0:00"),W=b("0:00"),g=b(0),p=b(null),v=b(null),R=T(()=>"speechSynthesis"in window);re(()=>{i.current_topic?.module_id&&(F.value[i.current_topic.module_id]=!0),Oe()}),qe(()=>{B.value&&clearInterval(B.value),Ee()});const he=s=>({topic:"Topic",quiz:"Quiz",project:"Project"})[s]||"Topic",ue=T(()=>{const s=i.current_topic.type||"topic",t=[];return s==="topic"?(t.push({id:"content",name:"Content",icon:Bt,badge:i.current_topic.contents?.length||"0",badgeClass:"bg-emerald-100 text-emerald-800"}),t.push({id:"objectives",name:"Learning Guide",icon:et,badge:(i.current_topic.learning_objectives?.length||0)+(i.current_topic.key_concepts?.length||0),badgeClass:"bg-purple-100 text-purple-800"}),i.current_topic.has_quiz&&!i.current_topic.is_capstone&&t.push({id:"quiz",name:"Quiz",icon:ne,badge:i.current_topic.has_quiz?"Available":"None",badgeClass:i.current_topic.has_quiz?"bg-amber-100 text-amber-800":"bg-gray-100 text-gray-800"}),i.current_topic.has_project&&t.push({id:"project",name:"Project",icon:ge,badge:i.current_topic.has_project?"Available":"None",badgeClass:i.current_topic.has_project?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"})):s==="quiz"?t.push({id:"quiz",name:"Quiz",icon:ne,badge:"Available",badgeClass:i.current_topic.has_quiz?"bg-amber-100 text-amber-800":"bg-gray-100 text-gray-800"}):s==="project"&&(t.push({id:"project",name:"Project",icon:ge,badge:i.current_topic.has_project?"Available":"None",badgeClass:i.current_topic.has_project?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}),t.push({id:"objectives",name:"Learning Guide",icon:et,badge:(i.current_topic.learning_objectives?.length||0)+(i.current_topic.key_concepts?.length||0),badgeClass:"bg-purple-100 text-purple-800"})),t}),xe=s=>{const t=Math.floor(s/60),r=s%60;return`${t}:${r.toString().padStart(2,"0")}`},Me=s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),at=s=>({draft:"bg-gray-100 text-gray-800",active:"bg-emerald-100 text-emerald-800",paused:"bg-amber-100 text-amber-800",completed:"bg-teal-100 text-teal-800"})[s]||"bg-gray-100 text-gray-800",Pe=s=>{const t=i.course_structure.find(r=>r.topics.some(u=>u.id===s.id));if(t){const r=t.topics.findIndex(u=>u.id===s.id);return`${t.order}.${r+1}`}return"1.1"},fe=s=>s.topics?.length||0,ye=s=>s.topics?.filter(t=>t.is_completed).length||0,Fe=s=>{const t=s.topics.filter(u=>u.is_completed).length,r=s.topics.length;return r>0?Math.round(t/r*100):0},Oe=()=>{ee.value=new Date,B.value=setInterval(()=>{if(ee.value){const s=new Date;H.value=Math.round((s-ee.value)/1e3/60)}},6e4)},Ee=async()=>{if(H.value>0)try{await fetch(route("student.courses.update-progress",i.course.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({topic_id:i.current_topic.id,activity_type:"content_view",time_spent:H.value,completed:!1})})}catch(s){console.error("Error recording time:",s)}},te=T(()=>i.course_stats||{}),Z=T(()=>i.course_structure.find(s=>s.topics.some(t=>t.id===i.current_topic.id))),me=T(()=>i.course_structure.flatMap(s=>s.topics)),ve=T(()=>me.value.findIndex(s=>s.id===i.current_topic.id)),_e=T(()=>ve.value>0),we=T(()=>ve.value<me.value.length-1);T(()=>{if(!i.course.progress_tracking)return null;const s={};return i.course.progress_tracking.forEach(t=>{s[t.activity_type]||(s[t.activity_type]={completed:0,total:0}),s[t.activity_type].total++,t.is_completed&&s[t.activity_type].completed++}),Object.entries(s).map(([t,r])=>({type:t,...r}))});const pe=T(()=>i.current_topic.quiz?.attempts?.length||0),ae=T(()=>{const s=i.current_topic.quiz;return!s||!s.is_active?!1:s.max_attempts===0||pe.value<s.max_attempts}),lt=T(()=>ae.value&&k.value==="results"),nt=T(()=>ae.value?pe.value===0?"Start Quiz":`Attempt ${pe.value+1}`:"No Attempts Left"),le=T(()=>!i.current_topic.quiz||!i.current_topic.quiz.questions?null:i.current_topic.quiz.questions[h.value]),Re=s=>{Ee().then(()=>{L.get(route("student.courses.learn",{course:i.course.id,topic:s.id,tab:_.value})),q.value=!1})},Ie=s=>{F.value[s]=!F.value[s]},Le=()=>{if(_e.value){const s=me.value[ve.value-1];L.get(route("student.courses.learn",{course:i.course.id,topic:s.id,tab:_.value}))}},Ne=()=>{if(we.value){const s=me.value[ve.value+1];L.get(route("student.courses.learn",{course:i.course.id,topic:s.id,tab:_.value}))}},it=async()=>{E.value=!0;try{const s=H.value;await L.post(route("student.courses.complete-topic",{topic:i.current_topic.id}),{time_spent:s},{preserveScroll:!0,onSuccess:()=>{ee.value=new Date,H.value=0,L.reload({preserveScroll:!0})}})}catch(s){console.error("Error marking as complete:",s),alert("Failed to mark as complete. Please try again.")}finally{E.value=!1}},dt=async s=>{w.value=!0;try{await L.post(route("student.outlines.generate-content",{course:i.course.id,outline:s.id}),{},{onSuccess:()=>{L.reload()},onError:t=>{console.error("Failed to generate content:",t),alert("Failed to generate content. Please try again.")},onFinish:()=>{w.value=!1}})}catch(t){console.error("Error generating content:",t),alert("An error occurred while generating content."),w.value=!1}};function ke(s){if(!s)return"";Je.setOptions({breaks:!0,gfm:!0,headerIds:!0,langPrefix:"language-"});const t=s.replace(/<\ï½œbeginâ–ofâ–sentence\ï½œ>/g,""),r=Je.parse(t);return Nt.sanitize(r)}const ct=async()=>{if(ae.value){C.value=!0,w.value=!0;try{const t=await(await fetch(route("student.quizzes.start",i.current_topic.quiz.id),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}})).json();if(t.success)$.value=t.attempt,j.value=new Array(t.quiz.questions.length).fill(null),h.value=0,y.value=null,k.value="active",i.current_topic.quiz&&(i.current_topic.quiz.questions=t.quiz.questions),t.quiz.time_limit_minutes&&ut(t.quiz.time_limit_minutes*60),L.replace(route("student.courses.learn",{course:i.course.id,topic:i.current_topic.id,tab:"quiz"}),{preserveState:!0,preserveScroll:!0,replace:!0});else throw new Error(t.message||"Failed to start quiz")}catch(s){console.error("Failed to start quiz:",s),alert("Failed to start quiz: "+s.message)}finally{C.value=!1,w.value=!1}}},ut=s=>{V.value=s,B.value=setInterval(()=>{V.value--,V.value<=0&&(clearInterval(B.value),De())},1e3)},Qe=s=>{y.value=s,j.value[h.value]=s},mt=()=>{h.value<i.current_topic.quiz.questions.length-1&&(h.value++,y.value=j.value[h.value]||null)},vt=()=>{h.value>0&&(h.value--,y.value=j.value[h.value]||null)},De=async()=>{B.value&&clearInterval(B.value),C.value=!0;try{const s=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),r=await(await fetch(route("student.quizzes.submit",$.value.id),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":s},body:JSON.stringify({answers:j.value,_token:s})})).json();if(r.success)O.value=r.results,k.value="results",setTimeout(()=>{L.reload({preserveScroll:!0,only:["current_topic"]})},500);else throw new Error(r.message||"Failed to submit quiz")}catch(s){console.error("Failed to submit quiz:",s),alert("Failed to submit quiz: "+s.message)}finally{C.value=!1,w.value=!1}},pt=async s=>{try{const r=await(await fetch(route("student.quiz-attempts.result",{attempt:s.id}),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}})).json();if(r.success)O.value=r.results,k.value="results",_.value="quiz";else throw new Error(r.message||"Failed to load attempt results")}catch(t){console.error("Failed to load attempt results:",t),alert("Failed to load attempt results: "+t.message)}},gt=()=>{ae.value?(k.value="overview",O.value=null,$.value=null,j.value=[],y.value=null,h.value=0,V.value=0):alert("You have no attempts left for this quiz.")},bt=async s=>{C.value=!0,w.value=!0;try{await L.post(route("student.outlines.generate-quiz",{course:i.course.id,outline:s.id}),{},{onSuccess:()=>{L.reload({only:["current_topic"],onSuccess:()=>{_.value="quiz"}})},onError:t=>{console.error("Failed to generate quiz:",t),alert("Failed to generate quiz. Please try again.")}})}catch(t){console.error("Error generating quiz:",t),alert("An error occurred while generating quiz.")}finally{C.value=!1,w.value=!1}},ht=()=>{G.value="active"},xt=()=>{G.value="overview",U.value="",K.value=null},ft=s=>{K.value=s.target.files[0]},yt=async()=>{try{const s=new FormData;if(s.append("description",U.value),K.value&&s.append("file",K.value),(await fetch(route("student.projects.submit",{course:i.course.id,outline:i.current_topic.id}),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:s})).ok)G.value="overview",U.value="",K.value=null,L.reload();else throw new Error("Failed to submit project")}catch(s){console.error("Error submitting project:",s),alert("Failed to submit project. Please try again.")}},_t=()=>{i.current_topic.project_resources&&console.log("Downloading project resources")},wt=s=>{const t=[...s];for(let r=t.length-1;r>0;r--){const u=Math.floor(Math.random()*(r+1));[t[r],t[u]]=[t[u],t[r]]}return t},kt=T(()=>le.value?.options?wt(le.value.options):[]),Ve=T(()=>i.current_topic.contents?.length>0&&R.value);re(()=>{R.value&&(v.value=window.speechSynthesis)}),qe(()=>{$e()});const $t=s=>{if(!R.value){alert("Your browser does not support text-to-speech functionality.");return}$e();const t=je(ke(s.content));Be(t)},jt=()=>{if(!R.value){alert("Your browser does not support text-to-speech functionality.");return}M.value?Tt():Ct()},Ct=()=>{if(!i.current_topic.contents?.length)return;const s=i.current_topic.contents.map(t=>je(ke(t.content))).join(`
`);Be(s)},Be=s=>{if(!s.trim())return;const t=new SpeechSynthesisUtterance(s);t.rate=.9,t.pitch=1,t.volume=1;const u=v.value.getVoices().find(Q=>Q.name.includes("Google")||Q.name.includes("Samantha")||Q.name.includes("Karen"));u&&(t.voice=u),t.onstart=()=>{M.value=!0,qt()},t.onend=()=>{M.value=!1,g.value=100,Y.value=W.value},t.onerror=Q=>{console.error("Speech synthesis error:",Q),M.value=!1,alert("Error playing audio. Please try again.")};const se=s.split(/\s+/).length,I=Math.ceil(se/3);W.value=xe(I),p.value=t,v.value.speak(t)},Tt=()=>{v.value&&M.value&&(v.value.pause(),M.value=!1)},$e=()=>{v.value&&(v.value.cancel(),M.value=!1,g.value=0,Y.value="0:00")},qt=()=>{if(M.value){const s=setInterval(()=>{if(!M.value){clearInterval(s);return}const t=g.value+1;t<=100?(g.value=t,Y.value=xe(Math.floor(parseInt(W.value)*(t/100)))):clearInterval(s)},1e3)}},je=s=>{const t=document.createElement("div");return t.innerHTML=s,t.textContent||t.innerText||""},zt=s=>{const r=je(s).split(/\s+/).length;return Math.ceil(r/200)},Ue=()=>{if(!i.active_tab){i.current_topic.type;const s=ue.value;s.length>0&&(_.value=s[0].id)}},Ge=T(()=>{const s=i.current_topic.type||"topic";return s==="topic"?i.current_topic.contents?.length>0:s==="quiz"?i.current_topic.quiz?.attempts?.some(r=>r.is_passed)||!1:s==="project"?i.current_topic.project_submissions?.some(r=>r.status==="approved")||i.current_topic.project_submissions?.length>0:!1}),St=T(()=>{const s=i.current_topic.type||"topic";return s==="topic"?"Complete the content to mark as complete":s==="quiz"?"Pass the quiz to mark as complete":s==="project"?"Submit the project to mark as complete":"Complete the requirements to mark as complete"});re(()=>{i.current_topic?.module_id&&(F.value[i.current_topic.module_id]=!0),Ue(),Oe()}),Ze(_,s=>{const t=new URL(window.location.href),r=new URLSearchParams(t.search);s&&s!=="content"?r.set("tab",s):r.delete("tab");const u=`${t.pathname}?${r.toString()}`;window.history.replaceState({},"",u)}),Ze(()=>i.current_topic,(s,t)=>{s.id!==t?.id&&(i.active_tab?_.value=i.active_tab:Ue(),s.has_quiz&&i.show_quiz_tab&&(_.value="quiz"))},{immediate:!0}),re(async()=>{try{const s=await axios.get(route("student.courses.chat.initialize",{course:i.course.id}));N.value=s.data.session}catch(s){console.error("Failed to pre-load chat session:",s)}});const At=()=>{try{if(!i.course_structure)return console.warn("course_structure prop is not defined"),[];if(!Array.isArray(i.course_structure))return console.warn("course_structure is not an array:",typeof i.course_structure),[];if(i.course_structure.length===0)return console.log("course_structure is empty array"),[];const s=[];return i.course_structure.forEach((t,r)=>{if(!t||typeof t!="object"){console.warn(`Invalid module at index ${r}`);return}const u=t.id||`module-${r}`,se=t.title||`Module ${t.order||r+1}`;if(!t.topics){console.warn(`Module ${u} has no topics property`);return}if(!Array.isArray(t.topics)){console.warn(`Module ${u} topics is not an array:`,typeof t.topics);return}t.topics.forEach((I,Q)=>{if(!I||typeof I!="object"){console.warn(`Invalid topic at index ${Q} in module ${u}`);return}const Mt=I.id||`topic-${r}-${Q}`,He=I.title||`Topic ${I.order||Q+1}`;s.push({id:Mt,title:He,order:I.order||Q+1,module_title:se,module_id:u,full_title:`${se} â†’ ${He}`,description:I.description||"",type:I.type||"topic",is_completed:I.is_completed||!1,estimated_duration_minutes:I.estimated_duration_minutes||0,has_quiz:I.has_quiz||!1,has_project:I.has_project||!1})})}),console.log(`Successfully extracted ${s.length} topics from ${i.course_structure.length} modules`),s}catch(s){return console.error("Unexpected error in getAllTopics:",s),[]}},Ke=T(()=>At());return re(()=>{console.log("Available topics:",Ke.value)}),(s,t)=>(o(),D(Lt,{"content-loading":w.value},{default:Ce(()=>[c(d(Rt),{title:`Learning: ${n.course.title}`},null,8,["title"]),e("div",yr,[e("div",_r,[e("div",wr,[e("div",kr,[c(d(Xe),{href:s.route("student.courses.show",n.course.id),class:"inline-flex items-center text-sm font-medium text-emerald-100 hover:text-white transition-colors mb-3"},{default:Ce(()=>[c(d(ce),{class:"h-4 w-4 mr-1"}),t[7]||(t[7]=x(" Back to Course Overview ",-1))]),_:1},8,["href"]),e("h1",$r,l(n.course.title),1),e("div",jr,[e("div",Cr,[e("div",Tr,[c(d(be),{class:"h-4 w-4 mr-1"}),x(" "+l(te.value.completed_modules||0)+"/"+l(te.value.total_modules||0)+" Modules ",1)])]),e("span",{class:f(["inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold",at(n.course.status)])},l(n.course.status),3)])]),e("div",qr,[e("div",zr,[e("div",null,[e("div",Sr,[t[8]||(t[8]=e("span",{class:"font-medium"},"Overall Progress",-1)),e("span",Ar,l(Math.round(te.value.overall_completion_percentage||0))+"%",1)]),e("div",Mr,[e("div",{class:"bg-gradient-to-r from-emerald-500 to-teal-500 h-3 rounded-full transition-all duration-500 ease-out",style:J({width:`${te.value.overall_completion_percentage||0}%`})},null,4)])])])]),e("div",Pr,[e("nav",Fr,[(o(!0),a(z,null,S(n.course_structure,r=>(o(),a("div",{key:r.id,class:"border border-gray-200 rounded-xl overflow-hidden"},[e("div",{onClick:u=>Ie(r.id),class:f(["flex items-center justify-between p-4 cursor-pointer transition-colors",F.value[r.id]?"bg-emerald-50 border-b border-emerald-100":"bg-white hover:bg-gray-50"])},[e("div",Er,[e("div",Rr,l(r.order),1),e("div",Ir,[e("h3",Lr,l(r.title),1),e("p",Nr,l(ye(r))+"/"+l(fe(r))+" topics â€¢ "+l(r.estimated_duration_minutes)+"min ",1)])]),e("div",Qr,[e("div",Dr,[e("div",{class:"bg-emerald-500 h-2 rounded-full transition-all duration-300",style:J({width:`${Fe(r)}%`})},null,4)]),e("span",Vr,l(Fe(r))+"% ",1),c(d(Ae),{class:f(["h-4 w-4 text-gray-400 transition-transform duration-200",{"rotate-180":F.value[r.id]}])},null,8,["class"])])],10,Or),F.value[r.id]?(o(),a("div",Br,[(o(!0),a(z,null,S(r.topics,u=>(o(),a("div",{key:u.id,onClick:se=>Re(u),class:f(["group flex items-center px-4 py-3 cursor-pointer transition-all duration-200",n.current_topic.id===u.id?"bg-white border-l-4 border-emerald-500 shadow-sm":"hover:bg-white hover:border-l-4 hover:border-emerald-200",(u.is_completed,"opacity-100")])},[e("div",Gr,[e("div",{class:f(["w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium mr-3 flex-shrink-0 border-2",n.current_topic.id===u.id||u.is_completed?"bg-emerald-500 text-white border-emerald-500":"bg-white text-gray-400 border-gray-300"])},[u.is_completed?(o(),D(d(X),{key:0,class:"h-3 w-3"})):(o(),a("span",Kr,l(Pe(u)),1))],2),e("div",Hr,[e("h4",Yr,l(u.title),1),e("p",Wr,[c(d(Se),{class:"h-3 w-3 mr-1"}),x(" "+l(u.estimated_duration_minutes)+"min ",1),u.has_quiz?(o(),a("span",Zr,[c(d(de),{class:"h-3 w-3 mr-1"}),t[9]||(t[9]=x(" Quiz ",-1))])):m("",!0),u.has_project?(o(),a("span",Xr,[c(d(ge),{class:"h-3 w-3 mr-1"}),t[10]||(t[10]=x(" Project ",-1))])):m("",!0)])])]),e("div",Jr,[n.current_topic.id===u.id?(o(),a("div",eo)):m("",!0),!u.is_completed&&n.current_topic.id!==u.id?(o(),D(d(oe),{key:1,class:"h-4 w-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity"})):m("",!0)])],10,Ur))),128))])):m("",!0)]))),128))])]),e("div",to,[e("div",so,[_e.value?(o(),a("button",{key:0,onClick:Le,class:"flex items-center justify-center px-3 py-2.5 border border-emerald-300 text-emerald-700 font-medium rounded-lg hover:bg-emerald-50 transition-colors text-sm"},[c(d(ce),{class:"h-4 w-4 mr-1"}),t[11]||(t[11]=x(" Previous ",-1))])):m("",!0),we.value?(o(),a("button",{key:1,onClick:Ne,class:"flex items-center justify-center px-3 py-2.5 bg-gradient-to-r from-emerald-600 to-teal-600 text-white font-medium rounded-lg hover:from-emerald-700 hover:to-teal-700 transition-all duration-200 shadow-sm hover:shadow-md text-sm"},[t[12]||(t[12]=x(" Next ",-1)),c(d(ie),{class:"h-4 w-4 ml-1"})])):m("",!0)])])])]),e("div",ro,[e("div",oo,[e("div",ao,[e("div",lo,[e("button",{onClick:t[0]||(t[0]=r=>q.value=!0),class:"p-2 rounded-lg text-gray-500 hover:text-gray-700 hover:bg-gray-100 transition-colors"},[c(d(Qt),{class:"h-5 w-5"})]),e("div",no,[e("h1",io,l(n.course.title),1),e("p",co,l(Z.value?.title),1)])]),e("div",uo,[e("div",mo,[e("div",vo,l(Math.round(te.value.overall_completion_percentage||0))+"%",1),t[13]||(t[13]=e("div",{class:"text-xs text-gray-500"},"Complete",-1))])])])]),e("main",po,[e("div",go,[e("div",bo,[e("div",ho,[e("div",xo,[e("nav",fo,[c(d(Xe),{href:s.route("student.courses.show",n.course.id),class:"hover:text-gray-700 transition-colors"},{default:Ce(()=>[x(l(n.course.title),1)]),_:1},8,["href"]),c(d(ie),{class:"h-4 w-4"}),e("span",yo,l(Z.value?.title),1)]),e("div",_o,[e("div",wo,[e("div",ko,[e("span",$o,l(he(n.current_topic.type))+" "+l(Pe(n.current_topic)),1),e("span",jo,[c(d(Se),{class:"h-4 w-4 mr-1"}),x(" "+l(n.current_topic.estimated_duration_minutes)+" minutes ",1)])]),e("h1",Co,l(n.current_topic.title),1),n.current_topic.description?(o(),a("p",To,l(n.current_topic.description),1)):m("",!0)])])])]),Z.value?(o(),a("div",qo,[e("div",zo,[t[14]||(t[14]=e("span",{class:"text-sm font-medium text-gray-900"},"Module Progress",-1)),e("span",So,l(ye(Z.value))+"/"+l(fe(Z.value))+" topics ",1)]),e("div",Ao,[e("div",{class:"bg-gradient-to-r from-emerald-500 to-teal-500 h-2.5 rounded-full transition-all duration-500",style:J({width:`${ye(Z.value)/fe(Z.value)*100}%`})},null,4)])])):m("",!0)]),e("div",Mo,[e("div",Po,[e("nav",Fo,[(o(!0),a(z,null,S(ue.value,r=>(o(),a("button",{key:r.id,onClick:()=>{_.value=r.id},class:f(["py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200",_.value===r.id?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},[e("div",Eo,[(o(),D(It(r.icon),{class:"h-4 w-4 mr-2"})),x(" "+l(r.name)+" ",1),r.badge?(o(),a("span",{key:0,class:f(["ml-2 py-0.5 px-2 text-xs rounded-full",r.badgeClass])},l(r.badge),3)):m("",!0)])],10,Oo))),128))])]),e("div",Ro,[_.value==="content"?(o(),a("div",Io,[n.current_topic.contents?.length?(o(),a("div",Lo,[e("div",No,[e("div",Qo,[e("button",{onClick:jt,disabled:!Ve.value,class:"flex items-center justify-center w-12 h-12 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[M.value?(o(),D(d(Ht),{key:1,class:"h-6 w-6"})):(o(),D(d(oe),{key:0,class:"h-6 w-6"}))],8,Do),t[15]||(t[15]=e("div",null,[e("h3",{class:"font-semibold text-gray-900"},"Listen to Content"),e("p",{class:"text-sm text-gray-600"},"AI-generated audio narration")],-1))]),e("div",Vo,[e("span",Bo,l(Y.value)+" / "+l(W.value),1),e("button",{onClick:$e,disabled:!M.value,class:"text-gray-500 hover:text-gray-700 disabled:opacity-50"},[c(d(Yt),{class:"h-5 w-5"})],8,Uo)])]),Ve.value?(o(),a("div",Go,[e("div",{class:"bg-emerald-500 h-2 rounded-full transition-all duration-300",style:J({width:`${g.value}%`})},null,4)])):m("",!0)])):m("",!0),n.current_topic.contents?.length?(o(),a("div",Ko,[(o(!0),a(z,null,S(n.current_topic.contents,r=>(o(),a("div",{key:r.id,class:"prose prose-emerald max-w-none"},[e("div",{innerHTML:ke(r.content)},null,8,Ho),e("div",Yo,[e("button",{onClick:u=>$t(r),class:"flex items-center space-x-2 text-emerald-600 hover:text-emerald-700 font-medium"},[c(d(oe),{class:"h-5 w-5"}),t[16]||(t[16]=e("span",null,"Listen to this section",-1))],8,Wo),e("span",Zo,l(zt(r.content))+" min read/listen",1)])]))),128))])):(o(),a("div",Xo,[c(d(be),{class:"mx-auto h-16 w-16 text-gray-300 mb-4"}),t[17]||(t[17]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-2"},"Ready to Learn?",-1)),t[18]||(t[18]=e("p",{class:"text-gray-500 mb-6 max-w-md mx-auto"}," Generate personalized learning content for this topic. Olilearn AI will create engaging materials tailored to your learning style. ",-1)),e("button",{onClick:t[1]||(t[1]=r=>dt(n.current_topic)),disabled:w.value,class:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600 text-white font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed"},[c(d(be),{class:"h-5 w-5 mr-2"}),x(" "+l(w.value?"Generating Content...":"Start Learning"),1)],8,Jo)]))])):m("",!0),_.value==="objectives"?(o(),a("div",ea,[n.current_topic.learning_objectives?.length?(o(),a("div",ta,[t[19]||(t[19]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"What You'll Learn",-1)),e("div",sa,[(o(!0),a(z,null,S(n.current_topic.learning_objectives,(r,u)=>(o(),a("div",{key:u,class:"flex items-start p-4 bg-emerald-50 rounded-lg border border-emerald-100"},[c(d(X),{class:"h-5 w-5 text-emerald-600 mr-3 mt-0.5 flex-shrink-0"}),e("span",ra,l(r),1)]))),128))])])):m("",!0),n.current_topic.key_concepts?.length?(o(),a("div",oa,[t[20]||(t[20]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Key Concepts",-1)),e("div",aa,[(o(!0),a(z,null,S(n.current_topic.key_concepts,(r,u)=>(o(),a("span",{key:u,class:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-purple-100 text-purple-800"},[c(d(Ut),{class:"h-3 w-3 mr-1"}),x(" "+l(r),1)]))),128))])])):m("",!0),n.current_topic.resources?.length?(o(),a("div",la,[t[21]||(t[21]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Additional Resources",-1)),e("div",na,[(o(!0),a(z,null,S(n.current_topic.resources,(r,u)=>(o(),a("div",{key:u,class:"flex items-center p-3 bg-gray-50 rounded-lg border border-gray-200"},[c(d(Gt),{class:"h-4 w-4 text-gray-400 mr-3"}),e("span",ia,l(r),1)]))),128))])])):m("",!0)])):m("",!0),_.value==="quiz"?(o(),a("div",da,[k.value==="overview"&&n.current_topic.quiz?(o(),a("div",ca,[e("div",ua,[e("div",ma,[e("div",va,[e("h3",pa,l(n.current_topic.quiz.title),1),e("p",ga,l(n.current_topic.quiz.description),1),e("div",ba,[e("div",ha,[e("div",xa,l(n.current_topic.quiz.questions?.length||0),1),t[22]||(t[22]=e("div",{class:"text-amber-600"},"Questions",-1))]),e("div",fa,[e("div",ya,l(n.current_topic.quiz.time_limit_minutes),1),t[23]||(t[23]=e("div",{class:"text-amber-600"},"Minutes",-1))]),e("div",_a,[e("div",wa,l(n.current_topic.quiz.passing_score)+"%",1),t[24]||(t[24]=e("div",{class:"text-amber-600"},"Passing Score",-1))]),e("div",ka,[e("div",$a,l(pe.value)+"/"+l(n.current_topic.quiz.max_attempts),1),t[25]||(t[25]=e("div",{class:"text-amber-600"},"Attempts",-1))])])]),c(d(de),{class:"h-12 w-12 text-amber-400 ml-4 flex-shrink-0"})]),e("button",{onClick:ct,disabled:!ae.value||C.value,class:"w-full flex items-center justify-center px-6 py-3 bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-600 hover:to-amber-700 text-white font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed"},[c(d(oe),{class:"h-5 w-5 mr-2"}),x(" "+l(nt.value),1)],8,ja)]),n.current_topic.quiz.attempts?.length?(o(),a("div",Ca,[t[26]||(t[26]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Previous Attempts",-1)),e("div",Ta,[(o(!0),a(z,null,S(n.current_topic.quiz.attempts,r=>(o(),a("div",{key:r.id,class:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"},[e("div",qa,[e("div",{class:f(["w-10 h-10 rounded-full flex items-center justify-center text-white font-semibold text-sm",r.is_passed?"bg-emerald-500":"bg-red-500"])},l(Math.round(r.percentage))+"% ",3),e("div",null,[e("div",za," Attempt "+l(r.attempt_number),1),e("div",Sa,l(Me(r.completed_at)),1)])]),e("div",Aa,[e("span",{class:f(["inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold",r.is_passed?"bg-emerald-100 text-emerald-800":"bg-red-100 text-red-800"])},l(r.is_passed?"Passed":"Failed"),3),e("button",{onClick:u=>pt(r),class:"text-amber-600 hover:text-amber-700 font-medium text-sm"}," View Results ",8,Ma)])]))),128))])])):m("",!0)])):m("",!0),k.value==="active"&&$.value?(o(),a("div",Pa,[e("div",Fa,[e("div",Oa,[e("div",null,[e("h3",Ea,l(n.current_topic.quiz.title),1),e("p",Ra,"Question "+l(h.value+1)+" of "+l(n.current_topic.quiz.questions.length),1)]),e("div",Ia,[e("div",{class:f(["text-2xl font-bold text-gray-900",{"text-red-600":V.value<60}])},l(xe(V.value)),3),t[27]||(t[27]=e("div",{class:"text-sm text-gray-500"},"Time Remaining",-1))])]),e("div",La,[e("div",{class:"bg-amber-500 h-2.5 rounded-full transition-all duration-300",style:J({width:`${(h.value+1)/n.current_topic.quiz.questions.length*100}%`})},null,4)])]),e("div",Na,[e("h4",Qa,l(le.value.question),1),le.value.type==="multiple_choice"?(o(),a("div",Da,[(o(!0),a(z,null,S(kt.value,(r,u)=>(o(),a("button",{key:u,onClick:se=>Qe(r),class:f(["w-full text-left p-4 border rounded-xl transition-all duration-200",y.value===r?"border-amber-500 bg-amber-50 ring-2 ring-amber-200":"border-gray-200 hover:border-amber-300 hover:bg-amber-25"])},[e("div",Ba,[e("div",{class:f(["w-6 h-6 rounded-full border-2 flex items-center justify-center mr-3 flex-shrink-0",y.value===r?"border-amber-500 bg-amber-500 text-white":"border-gray-300"])},[y.value===r?(o(),D(d(tt),{key:0,class:"h-3 w-3"})):m("",!0)],2),e("span",Ua,l(r),1)])],10,Va))),128))])):m("",!0),le.value.type==="true_false"?(o(),a("div",Ga,[(o(),a(z,null,S(["True","False"],r=>e("button",{key:r,onClick:u=>Qe(r),class:f(["p-4 border rounded-xl transition-all duration-200 text-center",y.value===r?"border-amber-500 bg-amber-50 ring-2 ring-amber-200":"border-gray-200 hover:border-amber-300 hover:bg-amber-25"])},[e("span",Ha,l(r),1)],10,Ka)),64))])):m("",!0),e("div",Ya,[e("button",{onClick:vt,disabled:h.value===0,class:"flex items-center px-4 py-2.5 border border-emerald-300 text-emerald-700 font-medium rounded-lg hover:bg-emerald-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[c(d(ce),{class:"h-4 w-4 mr-2"}),t[28]||(t[28]=x(" Previous ",-1))],8,Wa),e("div",Za,[h.value<n.current_topic.quiz.questions.length-1?(o(),a("button",{key:0,onClick:mt,disabled:!y.value,class:"flex items-center px-6 py-2.5 bg-amber-500 hover:bg-amber-600 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[t[29]||(t[29]=x(" Next ",-1)),c(d(ie),{class:"h-4 w-4 ml-2"})],8,Xa)):(o(),a("button",{key:1,onClick:De,disabled:!y.value,class:"flex items-center px-6 py-2.5 bg-emerald-500 hover:bg-emerald-600 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[c(d(tt),{class:"h-4 w-4 mr-2"}),t[30]||(t[30]=x(" Submit Quiz ",-1))],8,Ja))])])])])):m("",!0),k.value==="results"&&O.value?(o(),a("div",el,[e("div",tl,[e("div",sl,[e("div",{class:f(["w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4 text-white text-2xl font-bold",O.value.is_passed?"bg-emerald-500":"bg-red-500"])},l(Math.round(O.value.percentage))+"% ",3),e("h3",rl,l(O.value.is_passed?"Congratulations!":"Keep Practicing!"),1),e("p",ol," You scored "+l(O.value.score)+" out of "+l(O.value.total_points)+" points ("+l(Math.round(O.value.percentage))+"%) ",1),e("div",al,[e("button",{onClick:t[2]||(t[2]=r=>k.value="overview"),class:"px-6 py-2.5 border border-emerald-300 text-emerald-700 font-medium rounded-lg hover:bg-emerald-50 transition-colors"}," Back to Overview "),lt.value?(o(),a("button",{key:0,onClick:gt,class:"px-6 py-2.5 bg-amber-500 hover:bg-amber-600 text-white font-medium rounded-lg transition-colors"}," Retake Quiz ")):m("",!0)])])]),e("div",ll,[t[34]||(t[34]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Question Review",-1)),e("div",nl,[(o(!0),a(z,null,S(O.value.detailed_results,(r,u)=>(o(),a("div",{key:u,class:f(["p-4 border rounded-xl",r.is_correct?"border-emerald-200 bg-emerald-50":"border-red-200 bg-red-50"])},[e("div",il,[e("h5",dl,"Question "+l(u+1),1),e("span",{class:f(["inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold",r.is_correct?"bg-emerald-100 text-emerald-800":"bg-red-100 text-red-800"])},l(r.is_correct?"Correct":"Incorrect"),3)]),e("p",cl,l(r.question),1),e("div",ul,[e("div",null,[t[31]||(t[31]=e("span",{class:"font-medium text-gray-500"},"Your answer:",-1)),e("p",{class:f(["mt-1",r.is_correct?"text-emerald-700":"text-red-700"])},l(r.user_answer||"No answer"),3)]),r.is_correct?m("",!0):(o(),a("div",ml,[t[32]||(t[32]=e("span",{class:"font-medium text-gray-500"},"Correct answer:",-1)),e("p",vl,l(r.correct_answer),1)]))]),r.explanation?(o(),a("div",pl,[t[33]||(t[33]=e("span",{class:"font-medium text-blue-700"},"Explanation:",-1)),e("p",gl,l(r.explanation),1)])):m("",!0)],2))),128))])])])):n.current_topic.quiz?m("",!0):(o(),a("div",bl,[c(d(de),{class:"mx-auto h-16 w-16 text-gray-300 mb-4"}),t[35]||(t[35]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-2"},"Ready to start this quiz?",-1)),t[36]||(t[36]=e("p",{class:"text-gray-500 mb-6 max-w-md mx-auto"}," Get the quiz for this topic to test your understanding. ",-1)),e("button",{onClick:t[3]||(t[3]=r=>bt(n.current_topic)),disabled:C.value,class:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-600 hover:to-amber-700 text-white font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed"},[c(d(de),{class:"h-5 w-5 mr-2"}),x(" "+l(C.value?"Generating Quiz...":"Generate Quiz"),1)],8,hl)]))])):m("",!0),_.value==="project"?(o(),a("div",xl,[e("div",fl,[e("div",yl,[e("div",_l,[t[40]||(t[40]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"Project Assignment",-1)),t[41]||(t[41]=e("p",{class:"text-gray-600 mb-4"}," This topic includes a hands-on project to apply what you've learned. ",-1)),e("div",wl,[e("div",kl,[e("div",$l,l(n.current_topic.estimated_duration_minutes)+"min",1),t[37]||(t[37]=e("div",{class:"text-purple-600"},"Estimated Time",-1))]),t[38]||(t[38]=e("div",{class:"text-center p-3 bg-white rounded-lg border border-purple-100"},[e("div",{class:"font-bold text-purple-700"},"Hands-on"),e("div",{class:"text-purple-600"},"Project Type")],-1)),t[39]||(t[39]=e("div",{class:"text-center p-3 bg-white rounded-lg border border-purple-100"},[e("div",{class:"font-bold text-purple-700"},"Required"),e("div",{class:"text-purple-600"},"Completion")],-1))])]),c(d(ge),{class:"h-12 w-12 text-purple-400 ml-4 flex-shrink-0"})]),n.course.capstone_project.requirements?(o(),a("div",jl,[t[42]||(t[42]=e("h4",{class:"font-semibold text-gray-900 mb-3"},"Project Requirements",-1)),e("div",Cl,[(o(!0),a(z,null,S(n.course.capstone_project.requirements,(r,u)=>(o(),a("div",{key:u,class:"flex items-start"},[c(d(X),{class:"h-4 w-4 text-purple-500 mr-2 mt-1 flex-shrink-0"}),e("span",Tl,l(r),1)]))),128))])])):m("",!0),e("div",ql,[e("button",{onClick:ht,class:"flex-1 flex items-center justify-center px-6 py-3 bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md"},[c(d(oe),{class:"h-5 w-5 mr-2"}),t[43]||(t[43]=x(" Start Project ",-1))]),n.current_topic.project_resources?(o(),a("button",{key:0,onClick:_t,class:"flex items-center px-4 py-3 border border-purple-300 text-purple-700 font-medium rounded-lg hover:bg-purple-50 transition-colors"},[c(d(Kt),{class:"h-5 w-5 mr-2"}),t[44]||(t[44]=x(" Resources ",-1))])):m("",!0)])]),G.value==="active"?(o(),a("div",zl,[t[47]||(t[47]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Submit Your Project",-1)),e("div",Sl,[e("div",null,[t[45]||(t[45]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Project Submission",-1)),ze(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=r=>U.value=r),rows:"6",class:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors",placeholder:"Describe your project implementation, include code snippets, screenshots, or any relevant details..."},null,512),[[st,U.value]])]),e("div",null,[t[46]||(t[46]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Attachment (Optional)",-1)),e("input",{type:"file",onChange:ft,class:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors"},null,32)]),e("div",Al,[e("button",{onClick:xt,class:"px-4 py-2.5 border border-emerald-300 text-emerald-700 font-medium rounded-lg hover:bg-emerald-50 transition-colors"}," Cancel "),e("button",{onClick:yt,disabled:!U.value.trim(),class:"px-6 py-2.5 bg-purple-500 hover:bg-purple-600 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," Submit Project ",8,Ml)])])])):m("",!0),n.current_topic.project_submissions?.length?(o(),a("div",Pl,[t[49]||(t[49]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Previous Submissions",-1)),e("div",Fl,[(o(!0),a(z,null,S(n.current_topic.project_submissions,r=>(o(),a("div",{key:r.id,class:"p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors"},[e("div",Ol,[e("div",El," Submitted "+l(Me(r.submitted_at)),1),r.status?(o(),a("span",{key:0,class:f(["inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold",r.status==="approved"?"bg-emerald-100 text-emerald-800":r.status==="rejected"?"bg-red-100 text-red-800":"bg-amber-100 text-amber-800"])},l(r.status),3)):m("",!0)]),e("p",Rl,l(r.description),1),r.feedback?(o(),a("div",Il,[t[48]||(t[48]=e("span",{class:"font-medium text-blue-700"},"Instructor Feedback:",-1)),e("p",Ll,l(r.feedback),1)])):m("",!0)]))),128))])])):m("",!0)])):m("",!0),_.value==="requirements"?(o(),a("div",Nl,[e("div",Ql,[e("div",Dl,[e("div",Vl,[t[53]||(t[53]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"Project Requirements",-1)),t[54]||(t[54]=e("p",{class:"text-gray-600 mb-4"}," Review the project requirements to understand what needs to be delivered for this project. ",-1)),e("div",Bl,[e("div",Ul,[e("div",Gl,l(n.current_topic.estimated_duration_minutes)+"min",1),t[50]||(t[50]=e("div",{class:"text-blue-600"},"Estimated Time",-1))]),t[51]||(t[51]=e("div",{class:"text-center p-3 bg-white rounded-lg border border-blue-100"},[e("div",{class:"font-bold text-blue-700"},"Hands-on"),e("div",{class:"text-blue-600"},"Project Type")],-1)),t[52]||(t[52]=e("div",{class:"text-center p-3 bg-white rounded-lg border border-blue-100"},[e("div",{class:"font-bold text-blue-700"},"Required"),e("div",{class:"text-blue-600"},"Completion")],-1))])]),c(d(ne),{class:"h-12 w-12 text-blue-400 ml-4 flex-shrink-0"})]),n.current_topic.project_requirements&&n.current_topic.project_requirements.length?(o(),a("div",Kl,[t[55]||(t[55]=e("h4",{class:"font-semibold text-gray-900 mb-3"},"Project Requirements",-1)),e("div",Hl,[(o(!0),a(z,null,S(n.current_topic.project_requirements,(r,u)=>(o(),a("div",{key:u,class:"flex items-start p-3 bg-blue-50 rounded-lg"},[c(d(X),{class:"h-4 w-4 text-blue-500 mr-2 mt-1 flex-shrink-0"}),e("div",null,[e("span",Yl,l(r),1)])]))),128))])])):(o(),a("div",Wl,[c(d(ne),{class:"mx-auto h-16 w-16 text-gray-300 mb-4"}),t[56]||(t[56]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-2"},"No Requirements Available",-1)),t[57]||(t[57]=e("p",{class:"text-gray-500 mb-6 max-w-md mx-auto"}," Generate project requirements to understand what needs to be delivered for this project. ",-1)),e("button",{onClick:t[5]||(t[5]=r=>s.generateRequirements(n.current_topic)),disabled:s.requirementsLoading,class:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed"},[c(d(ne),{class:"h-5 w-5 mr-2"}),x(" "+l(s.requirementsLoading?"Generating Requirements...":"Generate Requirements"),1)],8,Zl)]))])])):m("",!0)])]),e("div",Xl,[_e.value?(o(),a("button",{key:0,onClick:Le,class:"inline-flex items-center px-6 py-3 border border-emerald-300 text-emerald-700 font-medium rounded-lg hover:bg-emerald-50 transition-colors"},[c(d(ce),{class:"h-4 w-4 mr-2"}),t[58]||(t[58]=x(" Previous Topic ",-1))])):(o(),a("div",Jl)),e("div",en,[n.current_topic.is_completed?(o(),a("button",sn,[c(d(X),{class:"h-4 w-4 mr-2"}),t[59]||(t[59]=x(" Completed ",-1))])):(o(),a("button",{key:0,onClick:it,disabled:!Ge.value||E.value,class:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600 text-white font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed relative group",title:Ge.value?"":St.value},[c(d(X),{class:"h-4 w-4 mr-2"}),x(" "+l(E.value?"Marking...":"Mark as Complete"),1)],8,tn)),we.value?(o(),a("button",{key:2,onClick:Ne,class:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 text-white font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md"},[t[60]||(t[60]=x(" Next Topic ",-1)),c(d(ie),{class:"h-4 w-4 ml-2"})])):m("",!0)])])])])]),c(fr,{course:n.course,"available-topics":Ke.value,"initial-session":N.value},null,8,["course","available-topics","initial-session"]),c(Is,{open:q.value,onClose:t[6]||(t[6]=r=>q.value=!1),course:n.course,"course-structure":n.course_structure,"current-topic":n.current_topic,"course-stats":te.value,onSelectTopic:Re,onToggleModule:Ie,"expanded-modules":F.value},null,8,["open","course","course-structure","current-topic","course-stats","expanded-modules"])])]),_:1},8,["content-loading"]))}},zn=rt(rn,[["__scopeId","data-v-ba67e378"]]);export{zn as default};
