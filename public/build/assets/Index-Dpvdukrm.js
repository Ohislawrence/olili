import{f as p,a as e,o as u,r as x,d as q,c as G,w as c,b as l,h as a,p as H,g as y,x as v,t as n,i as m,e as w,s as J,q as M,z as K,F as $,j,n as A,v as N,A as Q,y as _}from"./app-9iTwA3vC.js";import{A as W}from"./AdminLayout-BNATRJWW.js";import{_ as X}from"./Pagination-B-vs5vzK.js";import{_ as Y}from"./ConfirmationModal-B8isnMdc.js";import{r as Z}from"./ArrowLeftIcon-BfYZPnun.js";import{r as T}from"./PlusIcon-B5yWEhlc.js";import{r as ee}from"./ArrowDownTrayIcon-mQQBqIHE.js";import{r as te}from"./UserGroupIcon-Cz7EhKcJ.js";import"./DropdownLink-BJxGAADP.js";import"./NavLink-CVNpfdyq.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./XMarkIcon-DR50bQrw.js";import"./UsersIcon-Dq-ijHz8.js";import"./ChatBubbleLeftRightIcon-B5E4Bl1m.js";import"./ChartBarIcon-DGOEscCD.js";import"./CurrencyDollarIcon-BD-2biuk.js";import"./EyeIcon-DsHcOT47.js";import"./Modal-DiBLSjck.js";import"./ExclamationTriangleIcon-D09Y4htZ.js";function se(r,d){return u(),p("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})])}const oe={class:"py-6"},re={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},le={class:"mb-8"},ae={class:"flex justify-between items-center"},ne={class:"flex items-center space-x-3"},de={class:"mt-1 text-sm text-gray-600"},ie={class:"flex space-x-3"},ue={class:"mb-6 bg-white shadow-sm rounded-lg border border-gray-200 p-4"},ce={class:"flex flex-col sm:flex-row gap-4"},me={class:"flex-1"},pe={class:"w-full sm:w-48"},fe={key:0,class:"w-full sm:w-48"},xe={class:"mt-4 pt-4 border-t border-gray-200"},ve={type:"submit",class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},ge={class:"mb-6 grid grid-cols-2 md:grid-cols-5 gap-4"},he={class:"text-2xl font-bold text-gray-900"},be={class:"bg-white shadow-sm rounded-lg border border-gray-200 overflow-hidden"},ye={class:"overflow-x-auto"},we={class:"min-w-full divide-y divide-gray-200"},_e={class:"bg-gray-50"},ke={scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Ce={class:"bg-white divide-y divide-gray-200"},Se={class:"px-6 py-4 whitespace-nowrap"},Ae=["value"],Ee={class:"px-6 py-4 whitespace-nowrap"},Ve={class:"flex items-center"},De={class:"flex-shrink-0 h-10 w-10"},Me={class:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center"},$e={class:"text-sm font-medium text-blue-800"},je={class:"ml-4"},Ne={class:"text-sm font-medium text-gray-900"},Te={class:"text-sm text-gray-500"},Be={class:"px-6 py-4 whitespace-nowrap"},Ue={class:"px-6 py-4 whitespace-nowrap"},Pe={class:"flex items-center space-x-2"},Fe={class:"w-32"},Oe={class:"w-full bg-gray-200 rounded-full h-2"},ze={class:"text-sm text-gray-900"},Le={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Ie={key:0},Re={key:1},qe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Ge={class:"flex space-x-2"},He=["onClick"],Je={key:0,class:"text-center py-12"},Ke={class:"mt-1 text-sm text-gray-500"},Qe={class:"mt-6"},We={key:0,class:"mt-6"},vt={__name:"Index",props:{course:Object,enrollments:Object,statuses:Object,filters:{type:Object,default:()=>({})}},setup(r){const d=r,f=x({search:d.filters?.search||"",status:d.filters?.status||""}),i=x([]),h=x(!1),g=x(""),k=x(!1),b=x(null),C=x(null),B=q(()=>{const o={enrolled:{name:"Enrolled",count:0,colorClass:"text-blue-600"},active:{name:"Active",count:0,colorClass:"text-green-600"},paused:{name:"Paused",count:0,colorClass:"text-amber-600"},completed:{name:"Completed",count:0,colorClass:"text-teal-600"},dropped:{name:"Dropped",count:0,colorClass:"text-red-600"}};return d.enrollments?.data&&d.enrollments.data.forEach(t=>{t?.status&&o[t.status]&&o[t.status].count++}),Object.values(o)}),U=o=>({enrolled:"bg-blue-100 text-blue-800",active:"bg-green-100 text-green-800",paused:"bg-amber-100 text-amber-800",completed:"bg-teal-100 text-teal-800",dropped:"bg-red-100 text-red-800"})[o]||"bg-gray-100 text-gray-800",P=o=>o>=80?"bg-green-500":o>=50?"bg-teal-500":o>=25?"bg-amber-500":"bg-red-500",S=o=>o?new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"N/A";let E=null;const F=()=>{clearTimeout(E),E=setTimeout(()=>{V()},300)},V=()=>{_.get(route("admin.courses.enrollments.index",d.course.id),f.value,{preserveState:!0,replace:!0})},O=()=>{h.value?i.value=d.enrollments.data.map(o=>o.id):i.value=[]},z=async()=>{!g.value||i.value.length===0||(g.value==="delete"?confirm(`Are you sure you want to remove ${i.value.length} enrollment(s)?`)&&await _.post(route("admin.courses.enrollments.bulk-destroy",d.course.id),{enrollment_ids:i.value},{preserveScroll:!0,onSuccess:()=>{i.value=[],h.value=!1}}):await _.post(route("admin.courses.enrollments.bulk-update",d.course.id),{enrollment_ids:i.value,status:g.value},{preserveScroll:!0,onSuccess:()=>{i.value=[],h.value=!1,g.value=""}}))},L=o=>{b.value=o,k.value=!0},I=async()=>{b.value&&await _.delete(route("admin.courses.enrollments.destroy",{course:d.course.id,enrollment:b.value.id}),{preserveScroll:!0,onSuccess:()=>{k.value=!1,b.value=null}})},R=async()=>{if(!C.value.files.length){alert("Please select a CSV file to import");return}const o=new FormData;o.append("csv_file",C.value.files[0]),await _.post(route("admin.courses.enrollments.import",d.course.id),o,{preserveScroll:!0,onSuccess:()=>{C.value.value=""}})};return(o,t)=>(u(),G(W,null,{default:c(()=>[l(a(H),{title:`Enrollments - ${r.course.title}`},null,8,["title"]),e("div",oe,[e("div",re,[e("div",le,[e("div",ae,[e("div",null,[e("div",ne,[l(a(v),{href:o.route("admin.courses.show",r.course.id),class:"text-gray-400 hover:text-gray-600"},{default:c(()=>[l(a(Z),{class:"h-5 w-5"})]),_:1},8,["href"]),e("div",null,[t[6]||(t[6]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Enrollments",-1)),e("p",de,n(r.course.title)+" â€¢ "+n(r.course.current_enrollment)+" enrolled students ",1)])])]),e("div",ie,[l(a(v),{href:o.route("admin.courses.enrollments.create",r.course.id),class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:c(()=>[l(a(T),{class:"h-4 w-4 mr-2"}),t[7]||(t[7]=m(" Add Enrollment ",-1))]),_:1},8,["href"]),l(a(v),{href:o.route("admin.courses.enrollments.export",r.course.id),class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:c(()=>[l(a(ee),{class:"h-4 w-4 mr-2"}),t[8]||(t[8]=m(" Export CSV ",-1))]),_:1},8,["href"])])])]),e("div",ue,[e("div",ce,[e("div",me,[w(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>f.value.search=s),type:"text",placeholder:"Search by name or email...",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-2 px-3",onInput:F},null,544),[[J,f.value.search]])]),e("div",pe,[w(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>f.value.status=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-2 px-3",onChange:V},[...t[9]||(t[9]=[e("option",{value:""},"All Status",-1),e("option",{value:"enrolled"},"Enrolled",-1),e("option",{value:"active"},"Active",-1),e("option",{value:"paused"},"Paused",-1),e("option",{value:"completed"},"Completed",-1),e("option",{value:"dropped"},"Dropped",-1)])],544),[[M,f.value.status]])]),i.value.length>0?(u(),p("div",fe,[w(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>g.value=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-2 px-3",onChange:z},[...t[10]||(t[10]=[e("option",{value:""},"Bulk Actions",-1),e("option",{value:"active"},"Mark as Active",-1),e("option",{value:"paused"},"Mark as Paused",-1),e("option",{value:"completed"},"Mark as Completed",-1),e("option",{value:"dropped"},"Mark as Dropped",-1),e("option",{value:"delete"},"Remove Enrollments",-1)])],544),[[M,g.value]])])):y("",!0)]),e("div",xe,[e("form",{onSubmit:K(R,["prevent"]),class:"flex items-center space-x-3"},[e("input",{type:"file",ref_key:"csvFile",ref:C,accept:".csv,.txt",class:"flex-1 text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,512),e("button",ve,[l(a(se),{class:"h-4 w-4 mr-2"}),t[11]||(t[11]=m(" Import CSV ",-1))]),l(a(v),{href:o.route("admin.courses.enrollments.export-template",r.course.id),class:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"},{default:c(()=>[...t[12]||(t[12]=[m(" Get Template ",-1)])]),_:1},8,["href"])],32)])]),e("div",ge,[(u(!0),p($,null,j(B.value,s=>(u(),p("div",{key:s.name,class:"bg-white rounded-lg border border-gray-200 p-4 text-center hover:shadow-md transition-shadow"},[e("div",he,n(s.count),1),e("div",{class:A(["text-sm",s.colorClass])},n(s.name),3)]))),128))]),e("div",be,[e("div",ye,[e("table",we,[e("thead",_e,[e("tr",null,[e("th",ke,[w(e("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=s=>h.value=s),onChange:O,class:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,544),[[N,h.value]])]),t[13]||(t[13]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Student ",-1)),t[14]||(t[14]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status ",-1)),t[15]||(t[15]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Progress ",-1)),t[16]||(t[16]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Dates ",-1)),t[17]||(t[17]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ",-1))])]),e("tbody",Ce,[(u(!0),p($,null,j(r.enrollments.data,s=>(u(),p("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",Se,[w(e("input",{type:"checkbox",value:s.id,"onUpdate:modelValue":t[4]||(t[4]=D=>i.value=D),class:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,8,Ae),[[N,i.value]])]),e("td",Ee,[e("div",Ve,[e("div",De,[e("div",Me,[e("span",$e,n(s.user.name.charAt(0).toUpperCase()),1)])]),e("div",je,[e("div",Ne,n(s.user.name),1),e("div",Te,n(s.user.email),1)])])]),e("td",Be,[e("span",{class:A(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium capitalize",U(s.status)])},n(s.status),3)]),e("td",Ue,[e("div",Pe,[e("div",Fe,[e("div",Oe,[e("div",{class:A(["h-2 rounded-full transition-all duration-300",P(s.progress_percentage)]),style:Q({width:`${s.progress_percentage}%`})},null,6)])]),e("span",ze,n(Math.round(s.progress_percentage))+"% ",1)])]),e("td",Le,[e("div",null,"Enrolled: "+n(S(s.enrolled_at)),1),s.started_at?(u(),p("div",Ie,"Started: "+n(S(s.started_at)),1)):y("",!0),s.completed_at?(u(),p("div",Re,"Completed: "+n(S(s.completed_at)),1)):y("",!0)]),e("td",qe,[e("div",Ge,[l(a(v),{href:o.route("admin.courses.enrollments.show",{course:r.course.id,enrollment:s.id}),class:"text-blue-600 hover:text-blue-900"},{default:c(()=>[...t[18]||(t[18]=[m(" View ",-1)])]),_:1},8,["href"]),l(a(v),{href:o.route("admin.courses.enrollments.edit",{course:r.course.id,enrollment:s.id}),class:"text-green-600 hover:text-green-900"},{default:c(()=>[...t[19]||(t[19]=[m(" Edit ",-1)])]),_:1},8,["href"]),e("button",{onClick:D=>L(s),class:"text-red-600 hover:text-red-900"}," Remove ",8,He)])])]))),128))])])]),r.enrollments.data.length===0?(u(),p("div",Je,[l(a(te),{class:"h-12 w-12 mx-auto text-gray-400"}),t[21]||(t[21]=e("h3",{class:"mt-2 text-sm font-semibold text-gray-900"},"No enrollments",-1)),e("p",Ke,n(f.value.search||f.value.status?"No enrollments match your filters.":"No students are enrolled in this course yet."),1),e("div",Qe,[l(a(v),{href:o.route("admin.courses.enrollments.create",r.course.id),class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700"},{default:c(()=>[l(a(T),{class:"h-4 w-4 mr-2"}),t[20]||(t[20]=m(" Add Enrollment ",-1))]),_:1},8,["href"])])])):y("",!0)]),r.enrollments.data.length?(u(),p("div",We,[l(X,{links:r.enrollments.links},null,8,["links"])])):y("",!0)])]),l(Y,{show:k.value,onClose:t[5]||(t[5]=s=>k.value=!1),onConfirm:I},{title:c(()=>[...t[22]||(t[22]=[m(" Remove Enrollment ",-1)])]),content:c(()=>[t[23]||(t[23]=m(" Are you sure you want to remove ",-1)),e("strong",null,n(b.value?.user?.name||"this student"),1),t[24]||(t[24]=m(" from this course? This action cannot be undone. ",-1))]),_:1},8,["show"])]),_:1}))}};export{vt as default};
