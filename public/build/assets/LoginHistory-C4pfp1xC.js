import{_ as p}from"./AppLayout-DPcTXJAr.js";import{_ as g}from"./Pagination-aoUp2l31.js";import{c as m,w as r,a as t,f as d,h as n,t as i,o as a,F as c,k as x,n as _,b as y}from"./app-D3YAM52T.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./XMarkIcon-C86sTzuS.js";import"./BellIcon-2iA5pVRV.js";const f={class:"py-12"},h={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},b={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},v={class:"p-6"},w={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},k={class:"bg-blue-50 p-4 rounded-lg"},D={class:"text-2xl font-bold text-blue-600"},H={class:"bg-green-50 p-4 rounded-lg"},L={class:"text-2xl font-bold text-green-600"},S={class:"bg-purple-50 p-4 rounded-lg"},A={class:"text-2xl font-bold text-purple-600"},B={key:0,class:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg"},C={class:"list-disc list-inside text-red-700"},F={class:"overflow-x-auto"},N={class:"min-w-full divide-y divide-gray-200"},V={class:"bg-white divide-y divide-gray-200"},j={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},q={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},O={class:"text-gray-500 text-xs"},T={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},$={class:"text-gray-500 text-xs"},z={class:"px-6 py-4 whitespace-nowrap"},E={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},R={key:1,class:"mt-4"},P={__name:"LoginHistory",props:{loginHistory:Object,stats:Object,suspiciousActivities:Array},setup(o){const u=l=>new Date(l).toLocaleString();return(l,e)=>(a(),m(p,{title:"Login History"},{header:r(()=>[...e[0]||(e[0]=[t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Login History ",-1)])]),default:r(()=>[t("div",f,[t("div",h,[t("div",b,[t("div",v,[t("div",w,[t("div",k,[e[1]||(e[1]=t("h3",{class:"text-lg font-semibold text-blue-800"},"Total Logins (30d)",-1)),t("p",D,i(o.stats.total_logins_30d),1)]),t("div",H,[e[2]||(e[2]=t("h3",{class:"text-lg font-semibold text-green-800"},"Success Rate",-1)),t("p",L,i(o.stats.success_rate_30d)+"%",1)]),t("div",S,[e[3]||(e[3]=t("h3",{class:"text-lg font-semibold text-purple-800"},"Unique Devices",-1)),t("p",A,i(o.stats.unique_devices),1)])]),o.suspiciousActivities.length?(a(),d("div",B,[e[4]||(e[4]=t("h3",{class:"text-lg font-semibold text-red-800 mb-2"},"Suspicious Activity Detected",-1)),t("ul",C,[(a(!0),d(c,null,x(o.suspiciousActivities,s=>(a(),d("li",{key:s},i(s),1))),128))])])):n("",!0),t("div",F,[t("table",N,[e[5]||(e[5]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date & Time"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Device"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Location"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Session Duration")])],-1)),t("tbody",V,[(a(!0),d(c,null,x(o.loginHistory,s=>(a(),d("tr",{key:s.id},[t("td",j,i(u(s.login_at)),1),t("td",q,[t("div",null,i(s.device_type),1),t("div",O,i(s.browser)+" on "+i(s.platform),1)]),t("td",T,[t("div",null,i(s.get_location),1),t("div",$,i(s.ip_address),1)]),t("td",z,[t("span",{class:_([s.was_successful?"bg-green-100 text-green-800":"bg-red-100 text-red-800","px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])},i(s.was_successful?"Success":"Failed"),3)]),t("td",E,i(s.get_session_duration_formatted),1)]))),128))])])]),o.loginHistory.meta?(a(),d("div",R,[y(g,{links:o.loginHistory.meta.links},null,8,["links"])])):n("",!0)])])])])]),_:1}))}};export{P as default};
