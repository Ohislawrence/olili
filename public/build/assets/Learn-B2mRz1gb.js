import{f as l,a as e,o,d as C,h as m,b as u,i as c,t as a,j as h,n as f,B as Z,F as P,k as F,c as V,g as b,m as se,N as qe,e as ze,s as St,Q as Mt,A as Ke,x as Je,C as At,L as Ue,p as Pt,w as Ce,q as Ft,y as We,l as Ot,z as U}from"./app-DoWifYP7.js";import{r as ne,S as It}from"./StudentLayout-gdPdWTgu.js";import{k as Ye}from"./marked.esm-B5D8JARp.js";import{r as Rt,p as Et}from"./purify.es-C1-jxRNj.js";import{_ as et}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as tt,c as Lt}from"./XMarkIcon-D4gPAp6C.js";import{r as xe}from"./AcademicCapIcon-BjtlQVIH.js";import{r as Me}from"./ChevronDownIcon-D7Uhyez8.js";import{r as X}from"./CheckCircleIcon-CWJX0NVs.js";import{r as Se}from"./ClockIcon-CIRkMFal.js";import{r as ie}from"./QuestionMarkCircleIcon-DgKVuKWS.js";import{r as Te}from"./ChatBubbleLeftRightIcon-G9vqLXK2.js";import{r as Nt}from"./ExclamationTriangleIcon-BYi0nCbB.js";import{r as Qt}from"./PaperAirplaneIcon-BSSG7Q-x.js";import{a as Dt,c as ae}from"./UserIcon-Brwvc3AS.js";import{r as Xe}from"./ListBulletIcon-C22PrwBW.js";import{r as Vt}from"./LinkIcon-BYQNxEnR.js";import{r as Ze}from"./CheckIcon-CEaKFyDx.js";import{r as Bt}from"./ArrowDownTrayIcon-ijquyFCD.js";import"./SparklesIcon-DQ90emY3.js";import"./PlusIcon-Dl4gEFk_.js";import"./BellIcon-Cp5Jegbg.js";import"./CreditCardIcon-B-NT9UhM.js";function he(n,i){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 0 0 .75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 0 0-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0 1 12 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 0 1-.673-.38m0 0A2.18 2.18 0 0 1 3 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 0 1 3.413-.387m7.5 0V5.25A2.25 2.25 0 0 0 13.5 3h-3a2.25 2.25 0 0 0-2.25 2.25v.894m7.5 0a48.667 48.667 0 0 0-7.5 0M12 12.75h.008v.008H12v-.008Z"})])}function de(n,i){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})])}function Gt(n,i){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.25 9v6m-4.5 0V9M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function re(n,i){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"})])}function Ht(n,i){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 9.563C9 9.252 9.252 9 9.563 9h4.874c.311 0 .563.252.563.563v4.874c0 .311-.252.563-.563.563H9.564A.562.562 0 0 1 9 14.437V9.564Z"})])}const Kt={key:0,class:"lg:hidden fixed inset-0 flex z-50"},Ut={class:"relative flex-1 flex flex-col max-w-xs w-full bg-white shadow-xl"},Wt={class:"absolute top-0 right-0 -mr-12 pt-4"},Yt={class:"flex flex-col h-full"},Xt={class:"p-6 bg-gradient-to-r from-emerald-600 to-teal-600 text-white"},Zt={class:"flex items-center justify-between mb-3"},Jt={class:"text-lg font-bold truncate"},es={class:"flex items-center justify-between text-sm text-emerald-100"},ts={class:"flex items-center"},ss={class:"p-4 border-b border-gray-200 bg-white"},rs={class:"space-y-3"},os={class:"flex justify-between text-sm text-gray-600 mb-1"},ls={class:"font-semibold"},as={class:"w-full bg-gray-200 rounded-full h-2.5"},ns={class:"grid grid-cols-2 gap-3 text-xs"},is={class:"text-center p-2 bg-emerald-50 rounded-lg"},ds={class:"font-bold text-emerald-700"},cs={class:"text-center p-2 bg-teal-50 rounded-lg"},us={class:"font-bold text-teal-700"},ms={class:"flex-1 overflow-y-auto"},vs={class:"p-4 space-y-2"},ps=["onClick"],gs={class:"flex items-center flex-1 min-w-0"},bs={class:"w-8 h-8 rounded-full bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center text-white font-bold text-sm mr-3 flex-shrink-0"},hs={class:"flex-1 min-w-0"},xs={class:"font-bold text-gray-900 truncate text-sm"},fs={class:"text-xs text-gray-500 mt-1"},ys={class:"flex items-center space-x-2 flex-shrink-0"},_s={class:"w-12 bg-gray-200 rounded-full h-1.5"},ws={key:0,class:"bg-gray-50 border-t border-gray-100"},ks=["onClick"],$s={class:"flex items-center flex-1 min-w-0"},js={key:1},Cs={class:"flex-1 min-w-0"},Ts={class:"text-sm font-medium text-gray-900 truncate"},qs={class:"text-xs text-gray-500 mt-0.5 flex items-center"},zs={key:0,class:"ml-2 inline-flex items-center"},Ss={class:"flex items-center space-x-2 flex-shrink-0 ml-2"},Ms={key:0,class:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"},As={class:"p-4 border-t border-gray-200 bg-white space-y-3"},Ps={class:"grid grid-cols-2 gap-2"},Fs={__name:"LearnMobileSidebar",props:{open:Boolean,course:Object,courseStructure:Array,currentTopic:Object,courseStats:Object,expandedModules:Object},emits:["close","selectTopic","toggleModule"],setup(n,{emit:i}){const L=n,q=i,A=C(()=>L.courseStructure.flatMap(y=>y.topics)),k=C(()=>A.value.findIndex(y=>y.id===L.currentTopic.id)),M=C(()=>k.value>0),$=C(()=>k.value<A.value.length-1),T=y=>{q("selectTopic",y),q("close")},z=()=>{if(M.value){const y=A.value[k.value-1];T(y)}},R=()=>{if($.value){const y=A.value[k.value+1];T(y)}},x=y=>({draft:"bg-gray-100 text-gray-800",active:"bg-emerald-100 text-emerald-800",paused:"bg-amber-100 text-amber-800",completed:"bg-teal-100 text-teal-800"})[y]||"bg-gray-100 text-gray-800";return(y,_)=>n.open?(o(),l("div",Kt,[e("div",{class:"fixed inset-0 bg-gray-600 bg-opacity-75 transition-opacity",onClick:_[0]||(_[0]=j=>y.$emit("close"))}),e("div",Ut,[e("div",Wt,[e("button",{onClick:_[1]||(_[1]=j=>y.$emit("close")),class:"ml-1 flex items-center justify-center h-10 w-10 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-colors"},[u(c(tt),{class:"h-6 w-6"})])]),e("div",Yt,[e("div",Xt,[e("div",Zt,[e("h2",Jt,a(n.course.title),1)]),e("div",es,[e("div",ts,[u(c(xe),{class:"h-4 w-4 mr-1"}),h(" "+a(n.courseStats.completed_modules||0)+"/"+a(n.courseStats.total_modules||0)+" Modules ",1)]),e("span",{class:f(["inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold",x(n.course.status)])},a(n.course.status),3)])]),e("div",ss,[e("div",rs,[e("div",null,[e("div",os,[_[2]||(_[2]=e("span",null,"Overall Progress",-1)),e("span",ls,a(n.courseStats.overall_completion_percentage||0)+"%",1)]),e("div",as,[e("div",{class:"bg-gradient-to-r from-emerald-500 to-teal-500 h-2.5 rounded-full transition-all duration-500",style:Z({width:`${n.courseStats.overall_completion_percentage||0}%`})},null,4)])]),e("div",ns,[e("div",is,[e("div",ds,a(n.courseStats.completed_modules||0)+"/"+a(n.courseStats.total_modules||0),1),_[3]||(_[3]=e("div",{class:"text-emerald-600"},"Modules",-1))]),e("div",cs,[e("div",us,a(n.courseStats.completed_topics||0)+"/"+a(n.courseStats.total_topics||0),1),_[4]||(_[4]=e("div",{class:"text-teal-600"},"Topics",-1))])])])]),e("div",ms,[e("nav",vs,[(o(!0),l(P,null,F(n.courseStructure,j=>(o(),l("div",{key:j.id,class:"border border-gray-200 rounded-xl overflow-hidden"},[e("div",{onClick:w=>y.$emit("toggleModule",j.id),class:f(["flex items-center justify-between p-4 cursor-pointer transition-colors",n.expandedModules[j.id]?"bg-emerald-50 border-b border-emerald-100":"bg-white hover:bg-gray-50"])},[e("div",gs,[e("div",bs,a(j.order),1),e("div",hs,[e("h3",xs,a(j.title),1),e("p",fs,a(j.completed_topics)+"/"+a(j.total_topics)+" topics â€¢ "+a(j.estimated_duration_minutes)+"min ",1)])]),e("div",ys,[e("div",_s,[e("div",{class:"bg-emerald-500 h-1.5 rounded-full transition-all duration-300",style:Z({width:`${j.completed_topics/j.total_topics*100}%`})},null,4)]),u(c(Me),{class:f(["h-4 w-4 text-gray-400 transition-transform duration-200",{"rotate-180":n.expandedModules[j.id]}])},null,8,["class"])])],10,ps),n.expandedModules[j.id]?(o(),l("div",ws,[(o(!0),l(P,null,F(j.topics,w=>(o(),l("div",{key:w.id,onClick:N=>T(w),class:f(["group flex items-center px-4 py-3 cursor-pointer transition-all duration-200 border-l-4",n.currentTopic.id===w.id?"bg-white border-emerald-500 shadow-sm":"hover:bg-white hover:border-emerald-200 border-transparent",(w.is_completed,"opacity-100")])},[e("div",$s,[e("div",{class:f(["w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium mr-3 flex-shrink-0 border-2",n.currentTopic.id===w.id||w.is_completed?"bg-emerald-500 text-white border-emerald-500":"bg-white text-gray-400 border-gray-300"])},[w.is_completed?(o(),V(c(X),{key:0,class:"h-3 w-3"})):(o(),l("span",js,a(w.order),1))],2),e("div",Cs,[e("h4",Ts,a(w.title),1),e("p",qs,[u(c(Se),{class:"h-3 w-3 mr-1"}),h(" "+a(w.estimated_duration_minutes)+"min ",1),w.has_quiz?(o(),l("span",zs,[u(c(ie),{class:"h-3 w-3 mr-1"}),_[5]||(_[5]=h(" Quiz ",-1))])):m("",!0)])])]),e("div",Ss,[n.currentTopic.id===w.id?(o(),l("div",Ms)):m("",!0),!w.is_completed&&n.currentTopic.id!==w.id?(o(),V(c(re),{key:1,class:"h-4 w-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity"})):m("",!0)])],10,ks))),128))])):m("",!0)]))),128))])]),e("div",As,[e("div",Ps,[M.value?(o(),l("button",{key:0,onClick:z,class:"flex items-center justify-center px-3 py-2.5 border border-emerald-300 text-emerald-700 font-medium rounded-lg hover:bg-emerald-50 transition-colors text-sm"},[u(c(de),{class:"h-4 w-4 mr-1"}),_[6]||(_[6]=h(" Previous ",-1))])):m("",!0),$.value?(o(),l("button",{key:1,onClick:R,class:"flex items-center justify-center px-3 py-2.5 bg-gradient-to-r from-emerald-600 to-teal-600 text-white font-medium rounded-lg hover:from-emerald-700 hover:to-teal-700 transition-all duration-200 shadow-sm hover:shadow-md text-sm"},[_[7]||(_[7]=h(" Next ",-1)),u(c(ne),{class:"h-4 w-4 ml-1"})])):m("",!0)])])])])])):m("",!0)}},Os=et(Fs,[["__scopeId","data-v-90d0849c"]]),Is={key:0,class:"fixed inset-0 z-50 overflow-hidden","aria-labelledby":"chat-modal",role:"dialog","aria-modal":"true"},Rs={class:"fixed inset-y-0 right-0 max-w-full flex"},Es={class:"h-full flex flex-col bg-white shadow-xl rounded-l-2xl overflow-hidden"},Ls={class:"bg-gradient-to-r from-emerald-600 to-teal-600 px-4 py-6 sm:px-6"},Ns={class:"flex items-center justify-between"},Qs={class:"flex items-center space-x-3"},Ds={class:"flex-shrink-0"},Vs={class:"h-10 w-10 bg-white/20 rounded-full flex items-center justify-center"},Bs={class:"mt-1 text-sm text-emerald-100"},Gs={key:0,class:"mt-4"},Hs={class:"relative"},Ks=["disabled"],Us=["value"],Ws={class:"absolute right-2 top-1/2 transform -translate-y-1/2 pointer-events-none"},Ys={key:0,class:"absolute right-8 top-1/2 transform -translate-y-1/2"},Xs={key:0,class:"text-xs text-emerald-200 mt-1 flex items-center"},Zs={key:0,class:"text-center py-8"},Js={class:"mx-auto h-16 w-16 bg-gradient-to-r from-emerald-500 to-teal-500 rounded-full flex items-center justify-center mb-4"},er={class:"text-sm text-gray-600 max-w-xs mx-auto"},tr={class:"text-emerald-600"},sr={key:1,class:"text-center py-8"},rr=["innerHTML"],or={key:0,class:"ml-2 px-1.5 py-0.5 bg-amber-100 text-amber-700 rounded text-xs"},lr={key:2,class:"flex justify-start"},ar={key:3,class:"flex justify-center"},nr={class:"bg-red-50 border border-red-200 rounded-2xl px-4 py-3 max-w-[85%]"},ir={class:"flex items-center"},dr={class:"text-sm text-red-700"},cr={class:"flex-1 relative"},ur=["onKeydown","disabled"],mr={class:"absolute bottom-2 right-2"},vr=["disabled"],pr={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},gr={key:0,class:"text-xs text-red-500 mt-2 text-center"},br={__name:"CourseChatPopup",props:{course:{type:Object,required:!0},availableTopics:{type:Array,default:()=>[]}},setup(n){const i=n,L=b(!1),q=b(""),A=b(!1),k=b(!1),M=b(!1),$=b(""),T=b([]),z=b(null),R=b(null),x=b(null),y=b(!1),_=C(()=>i.availableTopics||[]),j=b(""),w=()=>{y.value=window.innerWidth<768},N=async()=>{L.value=!0,x.value=null,M.value=!0;try{await G()}catch(p){console.error("Failed to initialize chat:",p),x.value="Failed to load chat. Please try again."}finally{M.value=!1}Ue(()=>{Q()})},B=()=>{L.value=!1,q.value="",x.value=null},G=async()=>{try{const p=await axios.get(route("student.courses.tutor.session",{course:i.course.id}));if(p.data.success)z.value=p.data.session,T.value=p.data.messages||[];else throw new Error(p.data.error||"Failed to load session")}catch(p){throw console.error("Failed to initialize session:",p),p}},H=async()=>{if(!q.value.trim()||A.value||q.value.length>500)return;const p=q.value.trim();q.value="",A.value=!0,k.value=!0,x.value=null;const v={id:Date.now(),sender_type:"user",message:p,created_at:new Date().toISOString(),is_related_to_topic:!0};T.value.push(v),Q();try{const g=await axios.post(route("student.courses.tutor.send-message",{course:i.course.id}),{message:p,outline_id:$.value||null});if(g.data.success){const E={id:g.data.message.id||Date.now()+1,sender_type:"ai",message:g.data.message.message,created_at:g.data.message.created_at,is_related_to_topic:g.data.message.is_related_to_topic,metadata:g.data.message.metadata};T.value.push(E),g.data.session_id&&!z.value&&(z.value={id:g.data.session_id})}else throw new Error(g.data.error||"Failed to send message")}catch(g){console.error("Failed to send message:",g);const E={id:Date.now()+1,sender_type:"ai",message:"I'm sorry, I'm having trouble responding right now. Please try again.",created_at:new Date().toISOString(),is_related_to_topic:!0};T.value.push(E),x.value="Failed to send message. Please try again."}finally{A.value=!1,k.value=!1,Q()}},J=async()=>{if(!z.value){await W();return}x.value=null,k.value=!0,j.value=z.value.course_outline_id;try{const p=await axios.post(route("student.courses.tutor.update-context",{course:i.course.id}),{outline_id:$.value||null,session_id:z.value.id});if(p.data.success){z.value&&(z.value.course_outline_id=$.value,z.value.topic_context=p.data.new_context);const v=$.value?_.value.find(E=>E.id===$.value)?.title:"General Course Questions",g={id:Date.now(),sender_type:"ai",message:`ðŸ“š <strong>Context Updated:</strong> Now focusing on <em>"${v}"</em>. Ask me anything specific about this topic!`,created_at:new Date().toISOString(),is_related_to_topic:!0,is_system:!0};T.value.push(g),Q()}else throw new Error(p.data.error||"Failed to update context")}catch(p){console.error("Context update failed:",p),$.value=j.value,p.response?.data?.error?x.value=p.response.data.error:p.response?.status===404?x.value="The selected topic was not found in this course.":p.response?.status===403?x.value="You do not have permission to modify this chat session.":p.code==="NETWORK_ERROR"?x.value="Network error. Please check your connection and try again.":x.value="Failed to update chat context. Please try again.",setTimeout(()=>{x.value=null},5e3)}finally{k.value=!1}},W=async()=>{x.value=null,k.value=!0;try{const p=$.value?"I'd like to focus on this specific topic.":"I'd like to discuss general course questions.",v=await axios.post(route("student.courses.tutor.send-message",{course:i.course.id}),{message:p,outline_id:$.value||null});if(v.data.success){z.value={id:v.data.session_id};const g={id:v.data.message.id||Date.now()+1,sender_type:"ai",message:v.data.message.message,created_at:v.data.message.created_at,is_related_to_topic:v.data.message.is_related_to_topic,metadata:v.data.message.metadata};T.value.push(g);const E=$.value?_.value.find(ue=>ue.id===$.value)?.title:"General Course Questions",oe={id:Date.now()+2,sender_type:"ai",message:`ðŸŽ¯ <strong>Chat Context Set:</strong> I'll focus on <em>"${E}"</em>. What would you like to know about this topic?`,created_at:new Date().toISOString(),is_related_to_topic:!0,is_system:!0};T.value.push(oe),Q()}else throw new Error(v.data.error||"Failed to create session")}catch(p){console.error("Failed to create session with context:",p),x.value="Failed to start chat with selected context. Please try again.",$.value=""}finally{k.value=!1}},I=p=>p?p.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`(.*?)`/g,'<code class="bg-gray-100 px-1 rounded text-xs">$1</code>').replace(/\n/g,"<br>"):"",ee=p=>p?new Date(p).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",Q=()=>{Ue(()=>{R.value&&(R.value.scrollTop=R.value.scrollHeight)})},K=p=>{p.key==="Escape"&&L.value&&B()},ce=()=>{w()};return se(()=>{document.addEventListener("keydown",K),window.addEventListener("resize",ce),w()}),qe(()=>{document.removeEventListener("keydown",K),window.removeEventListener("resize",ce)}),(p,v)=>(o(),l("div",null,[e("button",{onClick:N,class:f(["fixed z-40 flex items-center gap-2 px-4 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 group",["right-4 md:right-6",y.value?"bottom-20":"bottom-6"]]),title:"Ask AI Tutor"},[u(c(Te),{class:"h-5 w-5 group-hover:scale-110 transition-transform"}),v[2]||(v[2]=e("span",{class:"text-sm font-semibold whitespace-nowrap"},"Ask the Tutor",-1))],2),L.value?(o(),l("div",Is,[e("div",{class:"absolute inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:B}),e("div",Rs,[e("div",{class:f(["w-screen max-w-md h-full transform transition-transform duration-300 ease-in-out",L.value?"translate-x-0":"translate-x-full"])},[e("div",Es,[e("div",Ls,[e("div",Ns,[e("div",Qs,[e("div",Ds,[e("div",Vs,[u(c(Te),{class:"h-6 w-6 text-white"})])]),e("div",null,[v[3]||(v[3]=e("h2",{class:"text-lg font-bold text-white",id:"chat-modal"}," Oli Ai Tutor ",-1)),e("p",Bs,a(n.course.title),1)])]),e("button",{onClick:B,class:"rounded-md p-2 text-emerald-200 hover:text-white hover:bg-white/10 transition-colors focus:outline-none focus:ring-2 focus:ring-white"},[v[4]||(v[4]=e("span",{class:"sr-only"},"Close panel",-1)),u(c(tt),{class:"h-5 w-5"})])]),_.value.length>0?(o(),l("div",Gs,[v[8]||(v[8]=e("label",{class:"block text-xs font-medium text-emerald-100 mb-2"}," Focus on specific topic: ",-1)),e("div",Hs,[ze(e("select",{"onUpdate:modelValue":v[0]||(v[0]=g=>$.value=g),onChange:J,class:"w-full px-3 py-2 text-sm border border-emerald-300 rounded-lg focus:ring-2 focus:ring-white focus:border-white bg-emerald-500 text-white placeholder-emerald-200 appearance-none pr-8 transition-colors",disabled:k.value},[v[5]||(v[5]=e("option",{value:""},"General Course Questions",-1)),(o(!0),l(P,null,F(_.value,g=>(o(),l("option",{key:g.id,value:g.id},a(g.full_title||g.title),9,Us))),128))],40,Ks),[[St,$.value]]),e("div",Ws,[u(c(Me),{class:"h-4 w-4 text-emerald-200"})]),k.value?(o(),l("div",Ys,[...v[6]||(v[6]=[e("div",{class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},null,-1)])])):m("",!0)]),k.value?(o(),l("p",Xs,[...v[7]||(v[7]=[e("div",{class:"animate-spin rounded-full h-3 w-3 border-b-2 border-emerald-200 mr-1"},null,-1),h(" Updating context... ",-1)])])):m("",!0)])):m("",!0)]),e("div",{ref_key:"messagesContainer",ref:R,class:f(["flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50/50",y.value?"pb-20":""])},[T.value.length===0&&!M.value?(o(),l("div",Zs,[e("div",Js,[u(c(Te),{class:"h-8 w-8 text-white"})]),v[11]||(v[11]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-2"}," Welcome to AI Tutor! ",-1)),e("p",er,[v[9]||(v[9]=h(" Ask me anything about ",-1)),e("strong",tr,a(n.course.title),1),v[10]||(v[10]=h(". I'm here to help you learn! ",-1))])])):m("",!0),M.value&&T.value.length===0?(o(),l("div",sr,[...v[12]||(v[12]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600 mx-auto mb-4"},null,-1),e("p",{class:"text-sm text-gray-500"},"Loading chat...",-1)])])):m("",!0),(o(!0),l(P,null,F(T.value,(g,E)=>(o(),l("div",{key:g.id||E,class:f(["flex",{"justify-end":g.sender_type==="user","justify-start":g.sender_type==="ai"}])},[e("div",{class:f(["max-w-[85%] rounded-2xl px-4 py-3 shadow-sm transition-all duration-200",{"bg-gradient-to-r from-emerald-600 to-teal-600 text-white":g.sender_type==="user","bg-white border border-gray-200 shadow-sm":g.sender_type==="ai","border-l-4 border-l-emerald-500":g.sender_type==="ai"&&g.is_system}])},[e("div",{class:"text-sm leading-relaxed",innerHTML:I(g.message)},null,8,rr),e("p",{class:f(["text-xs mt-2 flex items-center",{"text-emerald-200":g.sender_type==="user","text-gray-500":g.sender_type==="ai"}])},[h(a(ee(g.created_at))+" ",1),g.sender_type==="ai"&&!g.is_related_to_topic?(o(),l("span",or," May be off-topic ")):m("",!0)],2)],2)],2))),128)),k.value?(o(),l("div",lr,[...v[13]||(v[13]=[Mt('<div class="bg-white border border-gray-200 rounded-2xl px-4 py-3 shadow-sm"><div class="flex items-center space-x-2"><div class="flex space-x-1"><div class="w-2 h-2 bg-emerald-400 rounded-full animate-bounce" style="animation-delay:0.1s;"></div><div class="w-2 h-2 bg-emerald-400 rounded-full animate-bounce" style="animation-delay:0.2s;"></div><div class="w-2 h-2 bg-emerald-400 rounded-full animate-bounce" style="animation-delay:0.3s;"></div></div><span class="text-xs text-gray-500">AI Tutor is typing...</span></div></div>',1)])])):m("",!0),x.value?(o(),l("div",ar,[e("div",nr,[e("div",ir,[u(c(Nt),{class:"h-4 w-4 text-red-500 mr-2"}),e("p",dr,a(x.value),1)])])])):m("",!0)],2),e("div",{class:f(["border-t border-gray-200 p-4 bg-white",y.value?"pb-6":""])},[e("form",{onSubmit:Ke(H,["prevent"]),class:"flex space-x-3"},[e("div",cr,[ze(e("textarea",{"onUpdate:modelValue":v[1]||(v[1]=g=>q.value=g),onKeydown:At(Ke(H,["exact","prevent"]),["enter"]),rows:"2",placeholder:"Ask a question about this course...",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 resize-none text-sm shadow-sm transition-colors",disabled:A.value||M.value},null,40,ur),[[Je,q.value]]),e("div",mr,[e("span",{class:f(["text-xs text-gray-400",{"text-emerald-600":q.value.length>0}])},a(q.value.length)+"/500 ",3)])]),e("button",{type:"submit",disabled:!q.value.trim()||A.value||M.value||q.value.length>500,class:f(["self-end px-4 py-3 bg-gradient-to-r from-emerald-600 to-teal-600 text-white rounded-xl hover:from-emerald-700 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-sm flex items-center justify-center min-w-[44px]",{"hover:scale-105":!A.value&&q.value.trim(),"transform scale-95":A.value}])},[A.value?(o(),l("div",pr)):(o(),V(c(Qt),{key:0,class:"h-4 w-4"}))],10,vr)],32),q.value.length>500?(o(),l("p",gr," Message too long. Please keep under 500 characters. ")):m("",!0)],2)])],2)])])):m("",!0)]))}},hr={class:"h-screen flex overflow-hidden bg-gradient-to-br from-slate-50 to-emerald-50"},xr={class:"hidden lg:flex lg:flex-shrink-0 lg:w-80 xl:w-96"},fr={class:"flex flex-col w-full border-r border-gray-200 bg-white shadow-sm"},yr={class:"p-6 bg-gradient-to-r from-emerald-600 to-teal-600 text-white"},_r={class:"text-xl font-bold leading-tight line-clamp-2 mb-2"},wr={class:"flex items-center justify-between"},kr={class:"flex items-center space-x-2"},$r={class:"flex items-center text-emerald-100 text-sm"},jr={class:"p-4 border-b border-gray-200 bg-white"},Cr={class:"space-y-4"},Tr={class:"flex justify-between text-sm text-gray-600 mb-2"},qr={class:"font-semibold"},zr={class:"w-full bg-gray-200 rounded-full h-3"},Sr={class:"flex-1 overflow-y-auto"},Mr={class:"p-4 space-y-2"},Ar=["onClick"],Pr={class:"flex items-center flex-1 min-w-0"},Fr={class:"w-8 h-8 rounded-full bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center text-white font-bold text-sm mr-3 flex-shrink-0"},Or={class:"flex-1 min-w-0"},Ir={class:"font-semibold text-gray-900 truncate"},Rr={class:"text-xs text-gray-500 mt-1"},Er={class:"flex items-center space-x-2 flex-shrink-0"},Lr={class:"w-20 bg-gray-200 rounded-full h-2"},Nr={class:"text-xs text-gray-500 font-medium"},Qr={key:0,class:"bg-gray-50 border-t border-gray-100"},Dr=["onClick"],Vr={class:"flex items-center flex-1 min-w-0"},Br={key:1},Gr={class:"flex-1 min-w-0"},Hr={class:"text-sm font-medium text-gray-900 truncate"},Kr={class:"text-xs text-gray-500 mt-0.5 flex items-center"},Ur={key:0,class:"ml-2 inline-flex items-center"},Wr={key:1,class:"ml-2 inline-flex items-center"},Yr={class:"flex items-center space-x-2 flex-shrink-0 ml-2"},Xr={key:0,class:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"},Zr={class:"p-4 border-t border-gray-200 bg-white space-y-3"},Jr={class:"grid grid-cols-2 gap-2"},eo={class:"flex flex-col w-0 flex-1 overflow-hidden"},to={class:"lg:hidden bg-white border-b border-gray-200 shadow-sm"},so={class:"flex items-center justify-between px-4 py-3"},ro={class:"flex items-center space-x-3"},oo={class:"flex-1 min-w-0"},lo={class:"text-sm font-semibold text-gray-900 truncate"},ao={class:"text-xs text-gray-500 truncate"},no={class:"flex items-center space-x-2"},io={class:"text-right"},co={class:"text-sm font-medium text-gray-900"},uo={class:"flex-1 relative overflow-y-auto focus:outline-none bg-transparent"},mo={class:"py-6 px-4 sm:px-6 lg:px-8 max-w-6xl mx-auto"},vo={class:"mb-6"},po={class:"flex items-start justify-between mb-4"},go={class:"flex-1"},bo={class:"flex items-center space-x-2 text-sm text-gray-500 mb-3"},ho={class:"text-gray-900 font-medium"},xo={class:"flex items-start justify-between"},fo={class:"flex-1"},yo={class:"flex items-center space-x-3 mb-2"},_o={class:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-emerald-100 text-emerald-800"},wo={class:"text-sm text-gray-500 flex items-center"},ko={class:"text-2xl lg:text-3xl font-bold text-gray-900 leading-tight"},$o={key:0,class:"mt-2 text-lg text-gray-600 leading-relaxed"},jo={key:0,class:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm"},Co={class:"flex items-center justify-between mb-2"},To={class:"text-sm text-gray-500"},qo={class:"w-full bg-gray-200 rounded-full h-2.5"},zo={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},So={class:"border-b border-gray-200"},Mo={class:"flex space-x-8 px-6","aria-label":"Tabs"},Ao=["onClick"],Po={class:"flex items-center"},Fo={class:"p-6"},Oo={key:0,class:"prose prose-lg max-w-none"},Io={key:0,class:"mb-6"},Ro={class:"flex items-center justify-between p-4 bg-emerald-50 rounded-lg border border-emerald-200"},Eo={class:"flex items-center space-x-4"},Lo=["disabled"],No={class:"flex items-center space-x-4"},Qo={class:"text-sm text-gray-500"},Do=["disabled"],Vo={key:0,class:"w-full bg-gray-200 rounded-full h-2 mt-2"},Bo={key:1,class:"space-y-6"},Go=["innerHTML"],Ho={class:"mt-4 flex items-center justify-between p-3 bg-gray-50 rounded-lg"},Ko=["onClick"],Uo={class:"text-sm text-gray-500"},Wo={key:2,class:"text-center py-12"},Yo=["disabled"],Xo={key:1,class:"space-y-6"},Zo={key:0},Jo={class:"grid gap-3"},el={class:"text-emerald-800"},tl={key:1},sl={class:"flex flex-wrap gap-2"},rl={key:2},ol={class:"space-y-2"},ll={class:"text-gray-700"},al={key:2,class:"space-y-6"},nl={key:0,class:"space-y-6"},il={class:"bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-xl p-6"},dl={class:"flex items-start justify-between mb-4"},cl={class:"flex-1"},ul={class:"text-xl font-semibold text-gray-900 mb-2"},ml={class:"text-gray-600 mb-4"},vl={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},pl={class:"text-center p-3 bg-white rounded-lg border border-amber-100"},gl={class:"font-bold text-amber-700"},bl={class:"text-center p-3 bg-white rounded-lg border border-amber-100"},hl={class:"font-bold text-amber-700"},xl={class:"text-center p-3 bg-white rounded-lg border border-amber-100"},fl={class:"font-bold text-amber-700"},yl={class:"text-center p-3 bg-white rounded-lg border border-amber-100"},_l={class:"font-bold text-amber-700"},wl=["disabled"],kl={key:0,class:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm"},$l={class:"space-y-3"},jl={class:"flex items-center space-x-4"},Cl={class:"font-medium text-gray-900"},Tl={class:"text-sm text-gray-500"},ql={class:"flex items-center space-x-2"},zl=["onClick"],Sl={key:1,class:"space-y-6"},Ml={class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},Al={class:"flex items-center justify-between mb-4"},Pl={class:"text-xl font-semibold text-gray-900"},Fl={class:"text-gray-600"},Ol={class:"text-right"},Il={class:"w-full bg-gray-200 rounded-full h-2.5 mb-4"},Rl={class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},El={class:"text-lg font-semibold text-gray-900 mb-4"},Ll={key:0,class:"space-y-3"},Nl=["onClick"],Ql={class:"flex items-center"},Dl={class:"text-gray-700"},Vl={key:1,class:"grid grid-cols-2 gap-4"},Bl=["onClick"],Gl={class:"font-medium text-gray-700"},Hl={class:"flex justify-between items-center mt-6 pt-6 border-t border-gray-200"},Kl=["disabled"],Ul={class:"flex items-center space-x-3"},Wl=["disabled"],Yl=["disabled"],Xl={key:2,class:"space-y-6"},Zl={class:"bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-xl p-6"},Jl={class:"text-center"},ea={class:"text-2xl font-bold text-gray-900 mb-2"},ta={class:"text-gray-600 mb-4"},sa={class:"flex justify-center space-x-4"},ra={class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},oa={class:"space-y-4"},la={class:"flex items-start justify-between mb-2"},aa={class:"font-medium text-gray-900"},na={class:"text-gray-700 mb-3"},ia={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},da={key:0},ca={class:"mt-1 text-emerald-700"},ua={key:0,class:"mt-3 p-3 bg-blue-50 rounded-lg"},ma={class:"mt-1 text-blue-600"},va={key:3,class:"text-center py-12"},pa=["disabled"],ga={key:3,class:"space-y-6"},ba={class:"bg-gradient-to-r from-purple-50 to-indigo-50 border border-purple-200 rounded-xl p-6"},ha={class:"flex items-start justify-between mb-4"},xa={class:"flex-1"},fa={class:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm"},ya={class:"text-center p-3 bg-white rounded-lg border border-purple-100"},_a={class:"font-bold text-purple-700"},wa={key:0,class:"bg-white rounded-xl border border-purple-100 p-4 mb-4 shadow-sm"},ka={class:"space-y-2"},$a={class:"text-gray-700"},ja={class:"flex space-x-4"},Ca={key:0,class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},Ta={class:"space-y-4"},qa={class:"flex justify-end space-x-3"},za=["disabled"],Sa={key:1,class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},Ma={class:"space-y-3"},Aa={class:"flex items-center justify-between mb-2"},Pa={class:"font-medium text-gray-900"},Fa={class:"text-gray-600 text-sm mb-3"},Oa={key:0,class:"p-3 bg-blue-50 rounded-lg"},Ia={class:"mt-1 text-blue-600"},Ra={key:4,class:"space-y-6"},Ea={class:"bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-xl p-6"},La={class:"flex items-start justify-between mb-4"},Na={class:"flex-1"},Qa={class:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm"},Da={class:"text-center p-3 bg-white rounded-lg border border-blue-100"},Va={class:"font-bold text-blue-700"},Ba={key:0,class:"bg-white rounded-xl border border-blue-100 p-4 mb-4 shadow-sm"},Ga={class:"space-y-3"},Ha={class:"font-medium text-gray-900"},Ka={key:1,class:"text-center py-8"},Ua=["disabled"],Wa={class:"mt-8 flex justify-between items-center"},Ya={key:1},Xa={class:"flex items-center space-x-4"},Za=["disabled","title"],Ja={key:1,disabled:"",class:"inline-flex items-center px-6 py-3 bg-gray-400 text-white font-medium rounded-lg cursor-not-allowed"},en={__name:"Learn",props:{course:Object,course_structure:Array,current_topic:Object,course_stats:Object},setup(n){const i=n,L=b(null),q=b(!1),A=b(!1),k=b(!1),M=b(!1),$=b("content"),T=b({}),z=b("overview"),R=b(null),x=b(0),y=b(null),_=b([]),j=b(0),w=b(null),N=b(null),B=b("overview"),G=b(""),H=b(null),J=b(null),W=b(0),I=b(!1),ee=b("0:00"),Q=b("0:00"),K=b(0),ce=b(null),p=b(null),v=C(()=>"speechSynthesis"in window);se(()=>{i.current_topic?.module_id&&(T.value[i.current_topic.module_id]=!0),Fe()}),qe(()=>{N.value&&clearInterval(N.value),Oe()});const g=s=>({topic:"Topic",quiz:"Quiz",project:"Project"})[s]||"Topic",E=C(()=>{const s=i.current_topic.type||"topic",t=[];return s==="topic"?(t.push({id:"content",name:"Content",icon:Dt,badge:i.current_topic.contents?.length||"0",badgeClass:"bg-emerald-100 text-emerald-800"}),t.push({id:"objectives",name:"Learning Guide",icon:Xe,badge:(i.current_topic.learning_objectives?.length||0)+(i.current_topic.key_concepts?.length||0),badgeClass:"bg-purple-100 text-purple-800"}),i.current_topic.has_quiz&&!i.current_topic.is_capstone&&t.push({id:"quiz",name:"Quiz",icon:ae,badge:i.current_topic.has_quiz?"Available":"None",badgeClass:i.current_topic.has_quiz?"bg-amber-100 text-amber-800":"bg-gray-100 text-gray-800"}),i.current_topic.has_project&&t.push({id:"project",name:"Project",icon:he,badge:i.current_topic.has_project?"Available":"None",badgeClass:i.current_topic.has_project?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"})):s==="quiz"?t.push({id:"quiz",name:"Quiz",icon:ae,badge:"Available",badgeClass:i.current_topic.has_quiz?"bg-amber-100 text-amber-800":"bg-gray-100 text-gray-800"}):s==="project"&&(t.push({id:"project",name:"Project",icon:he,badge:i.current_topic.has_project?"Available":"None",badgeClass:i.current_topic.has_project?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}),t.push({id:"objectives",name:"Learning Guide",icon:Xe,badge:(i.current_topic.learning_objectives?.length||0)+(i.current_topic.key_concepts?.length||0),badgeClass:"bg-purple-100 text-purple-800"})),t}),oe=s=>{const t=Math.floor(s/60),r=s%60;return`${t}:${r.toString().padStart(2,"0")}`},ue=s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),st=s=>({draft:"bg-gray-100 text-gray-800",active:"bg-emerald-100 text-emerald-800",paused:"bg-amber-100 text-amber-800",completed:"bg-teal-100 text-teal-800"})[s]||"bg-gray-100 text-gray-800",Ae=s=>{const t=i.course_structure.find(r=>r.topics.some(d=>d.id===s.id));if(t){const r=t.topics.findIndex(d=>d.id===s.id);return`${t.order}.${r+1}`}return"1.1"},fe=s=>s.topics?.length||0,ye=s=>s.topics?.filter(t=>t.is_completed).length||0,Pe=s=>{const t=s.topics.filter(d=>d.is_completed).length,r=s.topics.length;return r>0?Math.round(t/r*100):0},Fe=()=>{J.value=new Date,N.value=setInterval(()=>{if(J.value){const s=new Date;W.value=Math.round((s-J.value)/1e3/60)}},6e4)},Oe=async()=>{if(W.value>0)try{await fetch(route("student.courses.update-progress",i.course.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({topic_id:i.current_topic.id,activity_type:"content_view",time_spent:W.value,completed:!1})})}catch(s){console.error("Error recording time:",s)}},te=C(()=>i.course_stats||{}),Y=C(()=>i.course_structure.find(s=>s.topics.some(t=>t.id===i.current_topic.id))),me=C(()=>i.course_structure.flatMap(s=>s.topics)),ve=C(()=>me.value.findIndex(s=>s.id===i.current_topic.id)),_e=C(()=>ve.value>0),we=C(()=>ve.value<me.value.length-1);C(()=>{if(!i.course.progress_tracking)return null;const s={};return i.course.progress_tracking.forEach(t=>{s[t.activity_type]||(s[t.activity_type]={completed:0,total:0}),s[t.activity_type].total++,t.is_completed&&s[t.activity_type].completed++}),Object.entries(s).map(([t,r])=>({type:t,...r}))});const pe=C(()=>i.current_topic.quiz?.attempts?.length||0),ge=C(()=>{const s=i.current_topic.quiz;return!s||!s.is_active?!1:s.max_attempts===0||pe.value<s.max_attempts}),rt=C(()=>ge.value&&z.value==="results"),ot=C(()=>ge.value?pe.value===0?"Start Quiz":`Attempt ${pe.value+1}`:"No Attempts Left"),le=C(()=>!i.current_topic.quiz||!i.current_topic.quiz.questions?null:i.current_topic.quiz.questions[x.value]),be=s=>{Oe().then(()=>{U.get(route("student.courses.learn",{course:i.course.id,topic:s.id})),q.value=!1})},Ie=s=>{T.value[s]=!T.value[s]},Re=()=>{if(_e.value){const s=me.value[ve.value-1];be(s)}},Ee=()=>{if(we.value){const s=me.value[ve.value+1];be(s)}},lt=async()=>{A.value=!0;try{const s=W.value;await U.post(route("student.courses.complete-topic",{topic:i.current_topic.id}),{time_spent:s},{preserveScroll:!0,onSuccess:()=>{J.value=new Date,W.value=0,U.reload({preserveScroll:!0})}})}catch(s){console.error("Error marking as complete:",s),alert("Failed to mark as complete. Please try again.")}finally{A.value=!1}},at=async s=>{k.value=!0;try{await U.post(route("student.outlines.generate-content",{course:i.course.id,outline:s.id}),{},{onSuccess:()=>{U.reload()},onError:t=>{console.error("Failed to generate content:",t),alert("Failed to generate content. Please try again.")},onFinish:()=>{k.value=!1}})}catch(t){console.error("Error generating content:",t),alert("An error occurred while generating content."),k.value=!1}};function ke(s){if(!s)return"";Ye.setOptions({breaks:!0,gfm:!0,headerIds:!0,langPrefix:"language-"});const t=s.replace(/<\ï½œbeginâ–ofâ–sentence\ï½œ>/g,""),r=Ye.parse(t);return Et.sanitize(r)}const nt=async()=>{if(ge.value){M.value=!0,k.value=!0;try{console.log("Starting quiz for:",i.current_topic.quiz.id);const s=await fetch(route("student.quizzes.start",i.current_topic.quiz.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});if(console.log("Response status:",s.status),s.ok){const t=await s.json();console.log("Quiz start response:",t),R.value=t.attempt,_.value=new Array(i.current_topic.quiz.questions.length).fill(null),x.value=0,y.value=null,z.value="active",i.current_topic.quiz.time_limit_minutes&&it(i.current_topic.quiz.time_limit_minutes*60)}else{const t=await s.json();throw console.error("Server error:",t),new Error(t.error||"Failed to start quiz")}}catch(s){console.error("Failed to start quiz:",s),alert("Failed to start quiz: "+s.message)}finally{M.value=!1,k.value=!1}}},it=s=>{j.value=s,N.value=setInterval(()=>{j.value--,j.value<=0&&(clearInterval(N.value),Ne())},1e3)},Le=s=>{y.value=s,_.value[x.value]=s},dt=()=>{x.value<i.current_topic.quiz.questions.length-1&&(x.value++,y.value=_.value[x.value]||null)},ct=()=>{x.value>0&&(x.value--,y.value=_.value[x.value]||null)},Ne=async()=>{N.value&&clearInterval(N.value),M.value=!0,k.value=!0;try{console.log("Submitting quiz attempt:",{attemptId:R.value.id,answers:_.value,answersCount:_.value.filter(S=>S!==null).length});const t=(()=>{const S=document.querySelector('meta[name="csrf-token"]');return S?S.getAttribute("content"):null})(),r={"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"};t&&(r["X-CSRF-TOKEN"]=t);const d=await fetch(route("student.quizzes.submit",R.value.id),{method:"POST",headers:r,body:JSON.stringify({answers:_.value,_token:t})});if(console.log("Submit response status:",d.status),d.ok){const S=await d.json();console.log("Quiz submitted successfully:",S),w.value=S,z.value="results"}else{let S;try{S=await d.json()}catch{S={error:`Server error: ${d.status} ${d.statusText}`}}throw console.error("Server error response:",S),new Error(S.error||S.message||`Failed to submit quiz: ${d.status}`)}}catch(s){console.error("Failed to submit quiz:",s),alert("Failed to submit quiz: "+s.message)}finally{M.value=!1,k.value=!1}},ut=()=>{z.value="overview",w.value=null,R.value=null},mt=s=>{alert(`Viewing results for attempt ${s.attempt_number}. This would show detailed results.`)},vt=async s=>{M.value=!0,k.value=!0;try{await U.post(route("student.outlines.generate-quiz",{course:i.course.id,outline:s.id}),{},{onSuccess:()=>{U.reload()},onError:t=>{console.error("Failed to generate quiz:",t),alert("Failed to generate quiz. Please try again.")}})}catch(t){console.error("Error generating quiz:",t),alert("An error occurred while generating quiz.")}finally{M.value=!1,k.value=!1}},pt=()=>{B.value="active"},gt=()=>{B.value="overview",G.value="",H.value=null},bt=s=>{H.value=s.target.files[0]},ht=async()=>{try{const s=new FormData;if(s.append("description",G.value),H.value&&s.append("file",H.value),(await fetch(route("student.projects.submit",{course:i.course.id,outline:i.current_topic.id}),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:s})).ok)B.value="overview",G.value="",H.value=null,U.reload();else throw new Error("Failed to submit project")}catch(s){console.error("Error submitting project:",s),alert("Failed to submit project. Please try again.")}},xt=()=>{i.current_topic.project_resources&&console.log("Downloading project resources")},ft=s=>{const t=[...s];for(let r=t.length-1;r>0;r--){const d=Math.floor(Math.random()*(r+1));[t[r],t[d]]=[t[d],t[r]]}return t},yt=C(()=>le.value?.options?ft(le.value.options):[]),Qe=C(()=>i.current_topic.contents?.length>0&&v.value);se(()=>{v.value&&(p.value=window.speechSynthesis)}),qe(()=>{$e()});const _t=s=>{if(!v.value){alert("Your browser does not support text-to-speech functionality.");return}$e();const t=je(ke(s.content));De(t)},wt=()=>{if(!v.value){alert("Your browser does not support text-to-speech functionality.");return}I.value?$t():kt()},kt=()=>{if(!i.current_topic.contents?.length)return;const s=i.current_topic.contents.map(t=>je(ke(t.content))).join(`
`);De(s)},De=s=>{if(!s.trim())return;const t=new SpeechSynthesisUtterance(s);t.rate=.9,t.pitch=1,t.volume=1;const d=p.value.getVoices().find(D=>D.name.includes("Google")||D.name.includes("Samantha")||D.name.includes("Karen"));d&&(t.voice=d),t.onstart=()=>{I.value=!0,jt()},t.onend=()=>{I.value=!1,K.value=100,ee.value=Q.value},t.onerror=D=>{console.error("Speech synthesis error:",D),I.value=!1,alert("Error playing audio. Please try again.")};const S=s.split(/\s+/).length,O=Math.ceil(S/3);Q.value=oe(O),ce.value=t,p.value.speak(t)},$t=()=>{p.value&&I.value&&(p.value.pause(),I.value=!1)},$e=()=>{p.value&&(p.value.cancel(),I.value=!1,K.value=0,ee.value="0:00")},jt=()=>{if(I.value){const s=setInterval(()=>{if(!I.value){clearInterval(s);return}const t=K.value+1;t<=100?(K.value=t,ee.value=oe(Math.floor(parseInt(Q.value)*(t/100)))):clearInterval(s)},1e3)}},je=s=>{const t=document.createElement("div");return t.innerHTML=s,t.textContent||t.innerText||""},Ct=s=>{const r=je(s).split(/\s+/).length;return Math.ceil(r/200)},Ve=()=>{i.current_topic.type;const s=E.value;s.length>0&&($.value=s[0].id)},Be=C(()=>{const s=i.current_topic.type||"topic";return s==="topic"?i.current_topic.contents?.length>0:s==="quiz"?i.current_topic.quiz?.attempts?.some(r=>r.is_passed)||!1:s==="project"?i.current_topic.project_submissions?.some(r=>r.status==="approved")||i.current_topic.project_submissions?.length>0:!1}),Tt=C(()=>{const s=i.current_topic.type||"topic";return s==="topic"?"Complete the content to mark as complete":s==="quiz"?"Pass the quiz to mark as complete":s==="project"?"Submit the project to mark as complete":"Complete the requirements to mark as complete"});se(()=>{i.current_topic?.module_id&&(T.value[i.current_topic.module_id]=!0),Ve(),Fe()}),Pt(()=>i.current_topic,()=>{Ve()},{immediate:!0}),se(async()=>{try{const s=await axios.get(route("student.courses.chat.initialize",{course:i.course.id}));L.value=s.data.session}catch(s){console.error("Failed to pre-load chat session:",s)}});const qt=()=>{try{if(!i.course_structure)return console.warn("course_structure prop is not defined"),[];if(!Array.isArray(i.course_structure))return console.warn("course_structure is not an array:",typeof i.course_structure),[];if(i.course_structure.length===0)return console.log("course_structure is empty array"),[];const s=[];return i.course_structure.forEach((t,r)=>{if(!t||typeof t!="object"){console.warn(`Invalid module at index ${r}`);return}const d=t.id||`module-${r}`,S=t.title||`Module ${t.order||r+1}`;if(!t.topics){console.warn(`Module ${d} has no topics property`);return}if(!Array.isArray(t.topics)){console.warn(`Module ${d} topics is not an array:`,typeof t.topics);return}t.topics.forEach((O,D)=>{if(!O||typeof O!="object"){console.warn(`Invalid topic at index ${D} in module ${d}`);return}const zt=O.id||`topic-${r}-${D}`,He=O.title||`Topic ${O.order||D+1}`;s.push({id:zt,title:He,order:O.order||D+1,module_title:S,module_id:d,full_title:`${S} â†’ ${He}`,description:O.description||"",type:O.type||"topic",is_completed:O.is_completed||!1,estimated_duration_minutes:O.estimated_duration_minutes||0,has_quiz:O.has_quiz||!1,has_project:O.has_project||!1})})}),console.log(`Successfully extracted ${s.length} topics from ${i.course_structure.length} modules`),s}catch(s){return console.error("Unexpected error in getAllTopics:",s),[]}},Ge=C(()=>qt());return se(()=>{console.log("Available topics:",Ge.value)}),(s,t)=>(o(),V(It,{"content-loading":k.value},{default:Ce(()=>[u(c(Ft),{title:`Learning: ${n.course.title}`},null,8,["title"]),e("div",hr,[e("div",xr,[e("div",fr,[e("div",yr,[u(c(We),{href:s.route("student.courses.show",n.course.id),class:"inline-flex items-center text-sm font-medium text-emerald-100 hover:text-white transition-colors mb-3"},{default:Ce(()=>[u(c(de),{class:"h-4 w-4 mr-1"}),t[7]||(t[7]=h(" Back to Course Overview ",-1))]),_:1},8,["href"]),e("h1",_r,a(n.course.title),1),e("div",wr,[e("div",kr,[e("div",$r,[u(c(xe),{class:"h-4 w-4 mr-1"}),h(" "+a(te.value.completed_modules||0)+"/"+a(te.value.total_modules||0)+" Modules ",1)])]),e("span",{class:f(["inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold",st(n.course.status)])},a(n.course.status),3)])]),e("div",jr,[e("div",Cr,[e("div",null,[e("div",Tr,[t[8]||(t[8]=e("span",{class:"font-medium"},"Overall Progress",-1)),e("span",qr,a(Math.round(te.value.overall_completion_percentage||0))+"%",1)]),e("div",zr,[e("div",{class:"bg-gradient-to-r from-emerald-500 to-teal-500 h-3 rounded-full transition-all duration-500 ease-out",style:Z({width:`${te.value.overall_completion_percentage||0}%`})},null,4)])])])]),e("div",Sr,[e("nav",Mr,[(o(!0),l(P,null,F(n.course_structure,r=>(o(),l("div",{key:r.id,class:"border border-gray-200 rounded-xl overflow-hidden"},[e("div",{onClick:d=>Ie(r.id),class:f(["flex items-center justify-between p-4 cursor-pointer transition-colors",T.value[r.id]?"bg-emerald-50 border-b border-emerald-100":"bg-white hover:bg-gray-50"])},[e("div",Pr,[e("div",Fr,a(r.order),1),e("div",Or,[e("h3",Ir,a(r.title),1),e("p",Rr,a(ye(r))+"/"+a(fe(r))+" topics â€¢ "+a(r.estimated_duration_minutes)+"min ",1)])]),e("div",Er,[e("div",Lr,[e("div",{class:"bg-emerald-500 h-2 rounded-full transition-all duration-300",style:Z({width:`${Pe(r)}%`})},null,4)]),e("span",Nr,a(Pe(r))+"% ",1),u(c(Me),{class:f(["h-4 w-4 text-gray-400 transition-transform duration-200",{"rotate-180":T.value[r.id]}])},null,8,["class"])])],10,Ar),T.value[r.id]?(o(),l("div",Qr,[(o(!0),l(P,null,F(r.topics,d=>(o(),l("div",{key:d.id,onClick:S=>be(d),class:f(["group flex items-center px-4 py-3 cursor-pointer transition-all duration-200",n.current_topic.id===d.id?"bg-white border-l-4 border-emerald-500 shadow-sm":"hover:bg-white hover:border-l-4 hover:border-emerald-200",(d.is_completed,"opacity-100")])},[e("div",Vr,[e("div",{class:f(["w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium mr-3 flex-shrink-0 border-2",n.current_topic.id===d.id||d.is_completed?"bg-emerald-500 text-white border-emerald-500":"bg-white text-gray-400 border-gray-300"])},[d.is_completed?(o(),V(c(X),{key:0,class:"h-3 w-3"})):(o(),l("span",Br,a(Ae(d)),1))],2),e("div",Gr,[e("h4",Hr,a(d.title),1),e("p",Kr,[u(c(Se),{class:"h-3 w-3 mr-1"}),h(" "+a(d.estimated_duration_minutes)+"min ",1),d.has_quiz?(o(),l("span",Ur,[u(c(ie),{class:"h-3 w-3 mr-1"}),t[9]||(t[9]=h(" Quiz ",-1))])):m("",!0),d.has_project?(o(),l("span",Wr,[u(c(he),{class:"h-3 w-3 mr-1"}),t[10]||(t[10]=h(" Project ",-1))])):m("",!0)])])]),e("div",Yr,[n.current_topic.id===d.id?(o(),l("div",Xr)):m("",!0),!d.is_completed&&n.current_topic.id!==d.id?(o(),V(c(re),{key:1,class:"h-4 w-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity"})):m("",!0)])],10,Dr))),128))])):m("",!0)]))),128))])]),e("div",Zr,[e("div",Jr,[_e.value?(o(),l("button",{key:0,onClick:Re,class:"flex items-center justify-center px-3 py-2.5 border border-emerald-300 text-emerald-700 font-medium rounded-lg hover:bg-emerald-50 transition-colors text-sm"},[u(c(de),{class:"h-4 w-4 mr-1"}),t[11]||(t[11]=h(" Previous ",-1))])):m("",!0),we.value?(o(),l("button",{key:1,onClick:Ee,class:"flex items-center justify-center px-3 py-2.5 bg-gradient-to-r from-emerald-600 to-teal-600 text-white font-medium rounded-lg hover:from-emerald-700 hover:to-teal-700 transition-all duration-200 shadow-sm hover:shadow-md text-sm"},[t[12]||(t[12]=h(" Next ",-1)),u(c(ne),{class:"h-4 w-4 ml-1"})])):m("",!0)])])])]),e("div",eo,[e("div",to,[e("div",so,[e("div",ro,[e("button",{onClick:t[0]||(t[0]=r=>q.value=!0),class:"p-2 rounded-lg text-gray-500 hover:text-gray-700 hover:bg-gray-100 transition-colors"},[u(c(Lt),{class:"h-5 w-5"})]),e("div",oo,[e("h1",lo,a(n.course.title),1),e("p",ao,a(Y.value?.title),1)])]),e("div",no,[e("div",io,[e("div",co,a(Math.round(te.value.overall_completion_percentage||0))+"%",1),t[13]||(t[13]=e("div",{class:"text-xs text-gray-500"},"Complete",-1))])])])]),e("main",uo,[e("div",mo,[e("div",vo,[e("div",po,[e("div",go,[e("nav",bo,[u(c(We),{href:s.route("student.courses.show",n.course.id),class:"hover:text-gray-700 transition-colors"},{default:Ce(()=>[h(a(n.course.title),1)]),_:1},8,["href"]),u(c(ne),{class:"h-4 w-4"}),e("span",ho,a(Y.value?.title),1)]),e("div",xo,[e("div",fo,[e("div",yo,[e("span",_o,a(g(n.current_topic.type))+" "+a(Ae(n.current_topic)),1),e("span",wo,[u(c(Se),{class:"h-4 w-4 mr-1"}),h(" "+a(n.current_topic.estimated_duration_minutes)+" minutes ",1)])]),e("h1",ko,a(n.current_topic.title),1),n.current_topic.description?(o(),l("p",$o,a(n.current_topic.description),1)):m("",!0)])])])]),Y.value?(o(),l("div",jo,[e("div",Co,[t[14]||(t[14]=e("span",{class:"text-sm font-medium text-gray-900"},"Module Progress",-1)),e("span",To,a(ye(Y.value))+"/"+a(fe(Y.value))+" topics ",1)]),e("div",qo,[e("div",{class:"bg-gradient-to-r from-emerald-500 to-teal-500 h-2.5 rounded-full transition-all duration-500",style:Z({width:`${ye(Y.value)/fe(Y.value)*100}%`})},null,4)])])):m("",!0)]),e("div",zo,[e("div",So,[e("nav",Mo,[(o(!0),l(P,null,F(E.value,r=>(o(),l("button",{key:r.id,onClick:d=>$.value=r.id,class:f(["py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200",$.value===r.id?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},[e("div",Po,[(o(),V(Ot(r.icon),{class:"h-4 w-4 mr-2"})),h(" "+a(r.name)+" ",1),r.badge?(o(),l("span",{key:0,class:f(["ml-2 py-0.5 px-2 text-xs rounded-full",r.badgeClass])},a(r.badge),3)):m("",!0)])],10,Ao))),128))])]),e("div",Fo,[$.value==="content"?(o(),l("div",Oo,[n.current_topic.contents?.length?(o(),l("div",Io,[e("div",Ro,[e("div",Eo,[e("button",{onClick:wt,disabled:!Qe.value,class:"flex items-center justify-center w-12 h-12 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[I.value?(o(),V(c(Gt),{key:1,class:"h-6 w-6"})):(o(),V(c(re),{key:0,class:"h-6 w-6"}))],8,Lo),t[15]||(t[15]=e("div",null,[e("h3",{class:"font-semibold text-gray-900"},"Listen to Content"),e("p",{class:"text-sm text-gray-600"},"AI-generated audio narration")],-1))]),e("div",No,[e("span",Qo,a(ee.value)+" / "+a(Q.value),1),e("button",{onClick:$e,disabled:!I.value,class:"text-gray-500 hover:text-gray-700 disabled:opacity-50"},[u(c(Ht),{class:"h-5 w-5"})],8,Do)])]),Qe.value?(o(),l("div",Vo,[e("div",{class:"bg-emerald-500 h-2 rounded-full transition-all duration-300",style:Z({width:`${K.value}%`})},null,4)])):m("",!0)])):m("",!0),n.current_topic.contents?.length?(o(),l("div",Bo,[(o(!0),l(P,null,F(n.current_topic.contents,r=>(o(),l("div",{key:r.id,class:"prose prose-emerald max-w-none"},[e("div",{innerHTML:ke(r.content)},null,8,Go),e("div",Ho,[e("button",{onClick:d=>_t(r),class:"flex items-center space-x-2 text-emerald-600 hover:text-emerald-700 font-medium"},[u(c(re),{class:"h-5 w-5"}),t[16]||(t[16]=e("span",null,"Listen to this section",-1))],8,Ko),e("span",Uo,a(Ct(r.content))+" min read/listen",1)])]))),128))])):(o(),l("div",Wo,[u(c(xe),{class:"mx-auto h-16 w-16 text-gray-300 mb-4"}),t[17]||(t[17]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-2"},"Ready to Learn?",-1)),t[18]||(t[18]=e("p",{class:"text-gray-500 mb-6 max-w-md mx-auto"}," Generate personalized learning content for this topic. Olilearn AI will create engaging materials tailored to your learning style. ",-1)),e("button",{onClick:t[1]||(t[1]=r=>at(n.current_topic)),disabled:k.value,class:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600 text-white font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed"},[u(c(xe),{class:"h-5 w-5 mr-2"}),h(" "+a(k.value?"Generating Content...":"Start Learning"),1)],8,Yo)]))])):m("",!0),$.value==="objectives"?(o(),l("div",Xo,[n.current_topic.learning_objectives?.length?(o(),l("div",Zo,[t[19]||(t[19]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"What You'll Learn",-1)),e("div",Jo,[(o(!0),l(P,null,F(n.current_topic.learning_objectives,(r,d)=>(o(),l("div",{key:d,class:"flex items-start p-4 bg-emerald-50 rounded-lg border border-emerald-100"},[u(c(X),{class:"h-5 w-5 text-emerald-600 mr-3 mt-0.5 flex-shrink-0"}),e("span",el,a(r),1)]))),128))])])):m("",!0),n.current_topic.key_concepts?.length?(o(),l("div",tl,[t[20]||(t[20]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Key Concepts",-1)),e("div",sl,[(o(!0),l(P,null,F(n.current_topic.key_concepts,(r,d)=>(o(),l("span",{key:d,class:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-purple-100 text-purple-800"},[u(c(Rt),{class:"h-3 w-3 mr-1"}),h(" "+a(r),1)]))),128))])])):m("",!0),n.current_topic.resources?.length?(o(),l("div",rl,[t[21]||(t[21]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Additional Resources",-1)),e("div",ol,[(o(!0),l(P,null,F(n.current_topic.resources,(r,d)=>(o(),l("div",{key:d,class:"flex items-center p-3 bg-gray-50 rounded-lg border border-gray-200"},[u(c(Vt),{class:"h-4 w-4 text-gray-400 mr-3"}),e("span",ll,a(r),1)]))),128))])])):m("",!0)])):m("",!0),$.value==="quiz"?(o(),l("div",al,[z.value==="overview"&&n.current_topic.quiz?(o(),l("div",nl,[e("div",il,[e("div",dl,[e("div",cl,[e("h3",ul,a(n.current_topic.quiz.title),1),e("p",ml,a(n.current_topic.quiz.description),1),e("div",vl,[e("div",pl,[e("div",gl,a(n.current_topic.quiz.questions?.length||0),1),t[22]||(t[22]=e("div",{class:"text-amber-600"},"Questions",-1))]),e("div",bl,[e("div",hl,a(n.current_topic.quiz.time_limit_minutes),1),t[23]||(t[23]=e("div",{class:"text-amber-600"},"Minutes",-1))]),e("div",xl,[e("div",fl,a(n.current_topic.quiz.passing_score)+"%",1),t[24]||(t[24]=e("div",{class:"text-amber-600"},"Passing Score",-1))]),e("div",yl,[e("div",_l,a(pe.value)+"/"+a(n.current_topic.quiz.max_attempts),1),t[25]||(t[25]=e("div",{class:"text-amber-600"},"Attempts",-1))])])]),u(c(ie),{class:"h-12 w-12 text-amber-400 ml-4 flex-shrink-0"})]),e("button",{onClick:nt,disabled:!ge.value||M.value,class:"w-full flex items-center justify-center px-6 py-3 bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-600 hover:to-amber-700 text-white font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed"},[u(c(re),{class:"h-5 w-5 mr-2"}),h(" "+a(ot.value),1)],8,wl)]),n.current_topic.quiz.attempts?.length?(o(),l("div",kl,[t[26]||(t[26]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Previous Attempts",-1)),e("div",$l,[(o(!0),l(P,null,F(n.current_topic.quiz.attempts,r=>(o(),l("div",{key:r.id,class:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"},[e("div",jl,[e("div",{class:f(["w-10 h-10 rounded-full flex items-center justify-center text-white font-semibold text-sm",r.is_passed?"bg-emerald-500":"bg-red-500"])},a(Math.round(r.percentage))+"% ",3),e("div",null,[e("div",Cl," Attempt "+a(r.attempt_number),1),e("div",Tl,a(ue(r.completed_at)),1)])]),e("div",ql,[e("span",{class:f(["inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold",r.is_passed?"bg-emerald-100 text-emerald-800":"bg-red-100 text-red-800"])},a(r.is_passed?"Passed":"Failed"),3),e("button",{onClick:d=>mt(r),class:"text-amber-600 hover:text-amber-700 font-medium text-sm"}," View Results ",8,zl)])]))),128))])])):m("",!0)])):m("",!0),z.value==="active"&&R.value?(o(),l("div",Sl,[e("div",Ml,[e("div",Al,[e("div",null,[e("h3",Pl,a(n.current_topic.quiz.title),1),e("p",Fl,"Question "+a(x.value+1)+" of "+a(n.current_topic.quiz.questions.length),1)]),e("div",Ol,[e("div",{class:f(["text-2xl font-bold text-gray-900",{"text-red-600":j.value<60}])},a(oe(j.value)),3),t[27]||(t[27]=e("div",{class:"text-sm text-gray-500"},"Time Remaining",-1))])]),e("div",Il,[e("div",{class:"bg-amber-500 h-2.5 rounded-full transition-all duration-300",style:Z({width:`${(x.value+1)/n.current_topic.quiz.questions.length*100}%`})},null,4)])]),e("div",Rl,[e("h4",El,a(le.value.question),1),le.value.type==="multiple_choice"?(o(),l("div",Ll,[(o(!0),l(P,null,F(yt.value,(r,d)=>(o(),l("button",{key:d,onClick:S=>Le(r),class:f(["w-full text-left p-4 border rounded-xl transition-all duration-200",y.value===r?"border-amber-500 bg-amber-50 ring-2 ring-amber-200":"border-gray-200 hover:border-amber-300 hover:bg-amber-25"])},[e("div",Ql,[e("div",{class:f(["w-6 h-6 rounded-full border-2 flex items-center justify-center mr-3 flex-shrink-0",y.value===r?"border-amber-500 bg-amber-500 text-white":"border-gray-300"])},[y.value===r?(o(),V(c(Ze),{key:0,class:"h-3 w-3"})):m("",!0)],2),e("span",Dl,a(r),1)])],10,Nl))),128))])):m("",!0),le.value.type==="true_false"?(o(),l("div",Vl,[(o(),l(P,null,F(["True","False"],r=>e("button",{key:r,onClick:d=>Le(r),class:f(["p-4 border rounded-xl transition-all duration-200 text-center",y.value===r?"border-amber-500 bg-amber-50 ring-2 ring-amber-200":"border-gray-200 hover:border-amber-300 hover:bg-amber-25"])},[e("span",Gl,a(r),1)],10,Bl)),64))])):m("",!0),e("div",Hl,[e("button",{onClick:ct,disabled:x.value===0,class:"flex items-center px-4 py-2.5 border border-emerald-300 text-emerald-700 font-medium rounded-lg hover:bg-emerald-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[u(c(de),{class:"h-4 w-4 mr-2"}),t[28]||(t[28]=h(" Previous ",-1))],8,Kl),e("div",Ul,[x.value<n.current_topic.quiz.questions.length-1?(o(),l("button",{key:0,onClick:dt,disabled:!y.value,class:"flex items-center px-6 py-2.5 bg-amber-500 hover:bg-amber-600 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[t[29]||(t[29]=h(" Next ",-1)),u(c(ne),{class:"h-4 w-4 ml-2"})],8,Wl)):(o(),l("button",{key:1,onClick:Ne,disabled:!y.value,class:"flex items-center px-6 py-2.5 bg-emerald-500 hover:bg-emerald-600 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[u(c(Ze),{class:"h-4 w-4 mr-2"}),t[30]||(t[30]=h(" Submit Quiz ",-1))],8,Yl))])])])])):m("",!0),z.value==="results"&&w.value?(o(),l("div",Xl,[e("div",Zl,[e("div",Jl,[e("div",{class:f(["w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4 text-white text-2xl font-bold",w.value.is_passed?"bg-emerald-500":"bg-red-500"])},a(Math.round(w.value.percentage))+"% ",3),e("h3",ea,a(w.value.is_passed?"Congratulations!":"Keep Practicing!"),1),e("p",ta," You scored "+a(w.value.score)+" out of "+a(w.value.total_points)+" points ("+a(Math.round(w.value.percentage))+"%) ",1),e("div",sa,[e("button",{onClick:t[2]||(t[2]=r=>z.value="overview"),class:"px-6 py-2.5 border border-emerald-300 text-emerald-700 font-medium rounded-lg hover:bg-emerald-50 transition-colors"}," Back to Overview "),rt.value?(o(),l("button",{key:0,onClick:ut,class:"px-6 py-2.5 bg-amber-500 hover:bg-amber-600 text-white font-medium rounded-lg transition-colors"}," Retake Quiz ")):m("",!0)])])]),e("div",ra,[t[34]||(t[34]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Question Review",-1)),e("div",oa,[(o(!0),l(P,null,F(w.value.detailed_results,(r,d)=>(o(),l("div",{key:d,class:f(["p-4 border rounded-xl",r.is_correct?"border-emerald-200 bg-emerald-50":"border-red-200 bg-red-50"])},[e("div",la,[e("h5",aa,"Question "+a(d+1),1),e("span",{class:f(["inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold",r.is_correct?"bg-emerald-100 text-emerald-800":"bg-red-100 text-red-800"])},a(r.is_correct?"Correct":"Incorrect"),3)]),e("p",na,a(r.question),1),e("div",ia,[e("div",null,[t[31]||(t[31]=e("span",{class:"font-medium text-gray-500"},"Your answer:",-1)),e("p",{class:f(["mt-1",r.is_correct?"text-emerald-700":"text-red-700"])},a(r.user_answer||"No answer"),3)]),r.is_correct?m("",!0):(o(),l("div",da,[t[32]||(t[32]=e("span",{class:"font-medium text-gray-500"},"Correct answer:",-1)),e("p",ca,a(r.correct_answer),1)]))]),r.explanation?(o(),l("div",ua,[t[33]||(t[33]=e("span",{class:"font-medium text-blue-700"},"Explanation:",-1)),e("p",ma,a(r.explanation),1)])):m("",!0)],2))),128))])])])):n.current_topic.quiz?m("",!0):(o(),l("div",va,[u(c(ie),{class:"mx-auto h-16 w-16 text-gray-300 mb-4"}),t[35]||(t[35]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-2"},"Ready to start this quiz?",-1)),t[36]||(t[36]=e("p",{class:"text-gray-500 mb-6 max-w-md mx-auto"}," Get the quiz for this topic to test your understanding. ",-1)),e("button",{onClick:t[3]||(t[3]=r=>vt(n.current_topic)),disabled:M.value,class:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-600 hover:to-amber-700 text-white font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed"},[u(c(ie),{class:"h-5 w-5 mr-2"}),h(" "+a(M.value?"Generating Quiz...":"Generate Quiz"),1)],8,pa)]))])):m("",!0),$.value==="project"?(o(),l("div",ga,[e("div",ba,[e("div",ha,[e("div",xa,[t[40]||(t[40]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"Project Assignment",-1)),t[41]||(t[41]=e("p",{class:"text-gray-600 mb-4"}," This topic includes a hands-on project to apply what you've learned. ",-1)),e("div",fa,[e("div",ya,[e("div",_a,a(n.current_topic.estimated_duration_minutes)+"min",1),t[37]||(t[37]=e("div",{class:"text-purple-600"},"Estimated Time",-1))]),t[38]||(t[38]=e("div",{class:"text-center p-3 bg-white rounded-lg border border-purple-100"},[e("div",{class:"font-bold text-purple-700"},"Hands-on"),e("div",{class:"text-purple-600"},"Project Type")],-1)),t[39]||(t[39]=e("div",{class:"text-center p-3 bg-white rounded-lg border border-purple-100"},[e("div",{class:"font-bold text-purple-700"},"Required"),e("div",{class:"text-purple-600"},"Completion")],-1))])]),u(c(he),{class:"h-12 w-12 text-purple-400 ml-4 flex-shrink-0"})]),n.course.capstone_project.requirements?(o(),l("div",wa,[t[42]||(t[42]=e("h4",{class:"font-semibold text-gray-900 mb-3"},"Project Requirements",-1)),e("div",ka,[(o(!0),l(P,null,F(n.course.capstone_project.requirements,(r,d)=>(o(),l("div",{key:d,class:"flex items-start"},[u(c(X),{class:"h-4 w-4 text-purple-500 mr-2 mt-1 flex-shrink-0"}),e("span",$a,a(r),1)]))),128))])])):m("",!0),e("div",ja,[e("button",{onClick:pt,class:"flex-1 flex items-center justify-center px-6 py-3 bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md"},[u(c(re),{class:"h-5 w-5 mr-2"}),t[43]||(t[43]=h(" Start Project ",-1))]),n.current_topic.project_resources?(o(),l("button",{key:0,onClick:xt,class:"flex items-center px-4 py-3 border border-purple-300 text-purple-700 font-medium rounded-lg hover:bg-purple-50 transition-colors"},[u(c(Bt),{class:"h-5 w-5 mr-2"}),t[44]||(t[44]=h(" Resources ",-1))])):m("",!0)])]),B.value==="active"?(o(),l("div",Ca,[t[47]||(t[47]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Submit Your Project",-1)),e("div",Ta,[e("div",null,[t[45]||(t[45]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Project Submission",-1)),ze(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=r=>G.value=r),rows:"6",class:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors",placeholder:"Describe your project implementation, include code snippets, screenshots, or any relevant details..."},null,512),[[Je,G.value]])]),e("div",null,[t[46]||(t[46]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Attachment (Optional)",-1)),e("input",{type:"file",onChange:bt,class:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors"},null,32)]),e("div",qa,[e("button",{onClick:gt,class:"px-4 py-2.5 border border-emerald-300 text-emerald-700 font-medium rounded-lg hover:bg-emerald-50 transition-colors"}," Cancel "),e("button",{onClick:ht,disabled:!G.value.trim(),class:"px-6 py-2.5 bg-purple-500 hover:bg-purple-600 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," Submit Project ",8,za)])])])):m("",!0),n.current_topic.project_submissions?.length?(o(),l("div",Sa,[t[49]||(t[49]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Previous Submissions",-1)),e("div",Ma,[(o(!0),l(P,null,F(n.current_topic.project_submissions,r=>(o(),l("div",{key:r.id,class:"p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors"},[e("div",Aa,[e("div",Pa," Submitted "+a(ue(r.submitted_at)),1),r.status?(o(),l("span",{key:0,class:f(["inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold",r.status==="approved"?"bg-emerald-100 text-emerald-800":r.status==="rejected"?"bg-red-100 text-red-800":"bg-amber-100 text-amber-800"])},a(r.status),3)):m("",!0)]),e("p",Fa,a(r.description),1),r.feedback?(o(),l("div",Oa,[t[48]||(t[48]=e("span",{class:"font-medium text-blue-700"},"Instructor Feedback:",-1)),e("p",Ia,a(r.feedback),1)])):m("",!0)]))),128))])])):m("",!0)])):m("",!0),$.value==="requirements"?(o(),l("div",Ra,[e("div",Ea,[e("div",La,[e("div",Na,[t[53]||(t[53]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"Project Requirements",-1)),t[54]||(t[54]=e("p",{class:"text-gray-600 mb-4"}," Review the project requirements to understand what needs to be delivered for this project. ",-1)),e("div",Qa,[e("div",Da,[e("div",Va,a(n.current_topic.estimated_duration_minutes)+"min",1),t[50]||(t[50]=e("div",{class:"text-blue-600"},"Estimated Time",-1))]),t[51]||(t[51]=e("div",{class:"text-center p-3 bg-white rounded-lg border border-blue-100"},[e("div",{class:"font-bold text-blue-700"},"Hands-on"),e("div",{class:"text-blue-600"},"Project Type")],-1)),t[52]||(t[52]=e("div",{class:"text-center p-3 bg-white rounded-lg border border-blue-100"},[e("div",{class:"font-bold text-blue-700"},"Required"),e("div",{class:"text-blue-600"},"Completion")],-1))])]),u(c(ae),{class:"h-12 w-12 text-blue-400 ml-4 flex-shrink-0"})]),n.current_topic.project_requirements&&n.current_topic.project_requirements.length?(o(),l("div",Ba,[t[55]||(t[55]=e("h4",{class:"font-semibold text-gray-900 mb-3"},"Project Requirements",-1)),e("div",Ga,[(o(!0),l(P,null,F(n.current_topic.project_requirements,(r,d)=>(o(),l("div",{key:d,class:"flex items-start p-3 bg-blue-50 rounded-lg"},[u(c(X),{class:"h-4 w-4 text-blue-500 mr-2 mt-1 flex-shrink-0"}),e("div",null,[e("span",Ha,a(r),1)])]))),128))])])):(o(),l("div",Ka,[u(c(ae),{class:"mx-auto h-16 w-16 text-gray-300 mb-4"}),t[56]||(t[56]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-2"},"No Requirements Available",-1)),t[57]||(t[57]=e("p",{class:"text-gray-500 mb-6 max-w-md mx-auto"}," Generate project requirements to understand what needs to be delivered for this project. ",-1)),e("button",{onClick:t[5]||(t[5]=r=>s.generateRequirements(n.current_topic)),disabled:s.requirementsLoading,class:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed"},[u(c(ae),{class:"h-5 w-5 mr-2"}),h(" "+a(s.requirementsLoading?"Generating Requirements...":"Generate Requirements"),1)],8,Ua)]))])])):m("",!0)])]),e("div",Wa,[_e.value?(o(),l("button",{key:0,onClick:Re,class:"inline-flex items-center px-6 py-3 border border-emerald-300 text-emerald-700 font-medium rounded-lg hover:bg-emerald-50 transition-colors"},[u(c(de),{class:"h-4 w-4 mr-2"}),t[58]||(t[58]=h(" Previous Topic ",-1))])):(o(),l("div",Ya)),e("div",Xa,[n.current_topic.is_completed?(o(),l("button",Ja,[u(c(X),{class:"h-4 w-4 mr-2"}),t[59]||(t[59]=h(" Completed ",-1))])):(o(),l("button",{key:0,onClick:lt,disabled:!Be.value||A.value,class:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600 text-white font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed relative group",title:Be.value?"":Tt.value},[u(c(X),{class:"h-4 w-4 mr-2"}),h(" "+a(A.value?"Marking...":"Mark as Complete"),1)],8,Za)),we.value?(o(),l("button",{key:2,onClick:Ee,class:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 text-white font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md"},[t[60]||(t[60]=h(" Next Topic ",-1)),u(c(ne),{class:"h-4 w-4 ml-2"})])):m("",!0)])])])])]),u(br,{course:n.course,"available-topics":Ge.value,"initial-session":L.value},null,8,["course","available-topics","initial-session"]),u(Os,{open:q.value,onClose:t[6]||(t[6]=r=>q.value=!1),course:n.course,"course-structure":n.course_structure,"current-topic":n.current_topic,"course-stats":te.value,onSelectTopic:be,onToggleModule:Ie,"expanded-modules":T.value},null,8,["open","course","course-structure","current-topic","course-stats","expanded-modules"])])]),_:1},8,["content-loading"]))}},jn=et(en,[["__scopeId","data-v-bd98d216"]]);export{jn as default};
